import{r as i,aC as K,c as p,o as e,S as V,av as L,R as Y,N as U,U as Z,ae as ee,X as se,w as h,z as E,c9 as d,c6 as te}from"./index-jd7Ax_Ed.js";import{u as D}from"./useMutation-n-l4Ns3H.js";import{D as ae}from"./ConfirmationDialog-EbANb_5f.js";import{a as re}from"./useConfirmation-BnXgMCcj.js";import{P as le}from"./plus-C2o0386P.js";import{P as ne}from"./phone-Dkvr6QGJ.js";import{P as ie}from"./pen-square-CzKMgeH3.js";import{T as oe}from"./trash-2-DCbqoVbR.js";import"./shield-DYPDNaY8.js";import"./check-circle-8oGxTki5.js";import"./info-D4lm7fBv.js";const Ne=()=>{var T,F,P,_;const[y,q]=i.useState(""),[f,R]=i.useState(""),[g,M]=i.useState(""),[o,m]=i.useState(1),[x,k]=i.useState(null),[A,j]=i.useState(!1),[t,r]=i.useState({firstName:"",lastName:"",employeeId:"",email:"",phone:"",position:"",department:"",hireDate:new Date().toISOString().split("T")[0],employmentType:"full_time",status:"active",salary:"",hourlyRate:"",payFrequency:"monthly",address:{street:"",city:"",state:"",zipCode:"",country:"US"},userAccount:"",notes:""}),b=K(),{showDeleteDialog:O,handleDeleteClick:z,handleDeleteConfirm:Q,handleDeleteCancel:$,itemToDelete:l}=re(),{data:c,isLoading:N,refetch:H}=p(["employees",{search:y,status:f,department:g,page:o}],()=>d.getEmployees({search:y,status:f,department:g,page:o,limit:20}),{keepPreviousData:!0,onError:s=>h(s,"Failed to fetch employees")}),{data:v}=p("users-for-employees",()=>te.getUsers({limit:100}).then(s=>{var a;return((a=s.data)==null?void 0:a.users)||[]}),{enabled:A,staleTime:5*60*1e3}),{data:w}=p("departments",d.getDepartments),{data:ce}=p("positions",d.getPositions),I=((T=c==null?void 0:c.data)==null?void 0:T.employees)||[],n=((F=c==null?void 0:c.data)==null?void 0:F.pagination)||{},C=D(d.createEmployee,{onSuccess:()=>{E("Employee created successfully"),b.invalidateQueries("employees"),u()},onError:s=>h(s,"Failed to create employee")}),S=D(({id:s,data:a})=>d.updateEmployee(s,a),{onSuccess:()=>{E("Employee updated successfully"),b.invalidateQueries("employees"),u()},onError:s=>h(s,"Failed to update employee")}),W=D(d.deleteEmployee,{onSuccess:()=>{E("Employee deleted successfully"),b.invalidateQueries("employees")},onError:s=>h(s,"Failed to delete employee")}),u=()=>{r({firstName:"",lastName:"",employeeId:"",email:"",phone:"",position:"",department:"",hireDate:new Date().toISOString().split("T")[0],employmentType:"full_time",status:"active",salary:"",hourlyRate:"",payFrequency:"monthly",address:{street:"",city:"",state:"",zipCode:"",country:"US"},userAccount:"",notes:""}),k(null),j(!1)},X=s=>{var a;k(s),r({firstName:s.firstName||"",lastName:s.lastName||"",employeeId:s.employeeId||"",email:s.email||"",phone:s.phone||"",position:s.position||"",department:s.department||"",hireDate:s.hireDate?new Date(s.hireDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],employmentType:s.employmentType||"full_time",status:s.status||"active",salary:s.salary||"",hourlyRate:s.hourlyRate||"",payFrequency:s.payFrequency||"monthly",address:s.address||{street:"",city:"",state:"",zipCode:"",country:"US"},userAccount:((a=s.userAccount)==null?void 0:a._id)||s.userAccount||"",notes:s.notes||""}),j(!0)},B=s=>{s.preventDefault();const a={...t};a.employeeId||delete a.employeeId,a.email||delete a.email,a.salary||delete a.salary,a.hourlyRate||delete a.hourlyRate,a.userAccount||delete a.userAccount,x?S.mutate({id:x._id,data:a}):C.mutate(a)},G=()=>{l&&W.mutate(l._id)},J=()=>{Q(),G()};return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employees"}),e.jsx("p",{className:"text-gray-600",children:"Manage your staff and employee records"})]}),e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search employees...",value:y,onChange:s=>{q(s.target.value),m(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]})}),e.jsx("div",{children:e.jsxs("select",{value:f,onChange:s=>{R(s.target.value),m(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})}),e.jsx("div",{children:e.jsxs("select",{value:g,onChange:s=>{M(s.target.value),m(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Departments"}),(_=(P=w==null?void 0:w.data)==null?void 0:P.departments)==null?void 0:_.map(s=>e.jsx("option",{value:s,children:s},s))]})})]})})}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-5 w-5 text-gray-600"}),e.jsxs("h2",{className:"text-lg font-semibold",children:["Employees (",n.total||0,")"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>H(),className:"btn btn-secondary btn-sm",disabled:N,children:[e.jsx(Y,{className:`h-4 w-4 mr-2 ${N?"animate-spin":""}`}),"Refresh"]}),e.jsxs("button",{onClick:()=>{u(),j(!0)},className:"btn btn-primary btn-sm",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Add Employee"]})]})]})}),e.jsxs("div",{className:"card-content",children:[N?e.jsx(U,{}):I.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(L,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No employees found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Employee ID"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Position"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Department"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Contact"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:I.map(s=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-sm",children:s.employeeId})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("span",{className:"font-medium",children:[s.firstName," ",s.lastName]})]})}),e.jsx("td",{className:"py-3 px-4",children:s.position}),e.jsx("td",{className:"py-3 px-4",children:s.department||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"text-sm",children:[s.email&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(ee,{className:"h-3 w-3 mr-1"}),s.email]}),s.phone&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),s.phone]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="active"?"bg-success-100 text-success-700":s.status==="terminated"?"bg-danger-100 text-danger-700":s.status==="on_leave"?"bg-warning-100 text-warning-700":"bg-gray-100 text-gray-700"}`,children:s.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>X(s),className:"btn btn-secondary btn-sm",title:"Edit",children:e.jsx(ie,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(s),className:"btn btn-danger btn-sm",title:"Delete",children:e.jsx(oe,{className:"h-4 w-4"})})]})})]},s._id))})]})}),n.pages>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(o-1)*(n.limit||20)+1," to"," ",Math.min(o*(n.limit||20),n.total)," of"," ",n.total," employees"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>m(s=>Math.max(1,s-1)),disabled:o===1,className:"btn btn-secondary btn-sm",children:"Previous"}),e.jsx("button",{onClick:()=>m(s=>Math.min(n.pages,s+1)),disabled:o===n.pages,className:"btn btn-secondary btn-sm",children:"Next"})]})]})]})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:x?"Edit Employee":"Add New Employee"}),e.jsx("button",{onClick:u,className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:B,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:t.firstName,onChange:s=>r({...t,firstName:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:t.lastName,onChange:s=>r({...t,lastName:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),e.jsx("input",{type:"text",value:t.employeeId,onChange:s=>r({...t,employeeId:s.target.value.toUpperCase()}),placeholder:"Auto-generated if left empty",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:t.email,onChange:s=>r({...t,email:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:t.phone,onChange:s=>r({...t,phone:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position *"}),e.jsx("input",{type:"text",required:!0,value:t.position,onChange:s=>r({...t,position:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:t.department,onChange:s=>r({...t,department:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hire Date *"}),e.jsx("input",{type:"date",required:!0,value:t.hireDate,onChange:s=>r({...t,hireDate:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("select",{value:t.employmentType,onChange:s=>r({...t,employmentType:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"full_time",children:"Full Time"}),e.jsx("option",{value:"part_time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"temporary",children:"Temporary"}),e.jsx("option",{value:"intern",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:t.status,onChange:s=>r({...t,status:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link User Account (Optional)"}),e.jsxs("select",{value:t.userAccount,onChange:s=>r({...t,userAccount:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"No User Account"}),v==null?void 0:v.filter(s=>!s.employeeLinked).map(s=>e.jsxs("option",{value:s._id,children:[s.firstName," ",s.lastName," (",s.email,")"]},s._id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Link to a system user account if employee needs POS access"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:u,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:C.isLoading||S.isLoading,children:C.isLoading||S.isLoading?e.jsx(U,{size:"sm"}):x?"Update Employee":"Add Employee"})]})]})]})})}),e.jsx(ae,{isOpen:O,onClose:$,onConfirm:J,title:"Delete Employee",message:`Are you sure you want to delete ${l==null?void 0:l.firstName} ${l==null?void 0:l.lastName}? This action cannot be undone.`})]})};export{Ne as default};
