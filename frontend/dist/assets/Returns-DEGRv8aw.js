import{D as We,G as Ve,r as R,aG as Xe,b as Ze,a3 as Je,p as e,X as O,S as Ge,O as xe,aZ as Ke,z as Ne,B as ve,y as me,P as ee,a2 as Ee,U as qe,aH as et,ak as Qe,C as $e,ad as tt,H as st,R as at,J as nt,x as Ie,K as rt,T as lt,a_ as it}from"./index-Cw3xRKpc.js";import{u as Be}from"./settingsApi-ygxRjDN0.js";import{A as Ae}from"./alert-circle-HQsWpy-L.js";import{P as Se}from"./plus-DxsvPhf3.js";import{P as Ye}from"./printer-Bdyt47kH.js";import{C as K}from"./check-circle-C7396OEq.js";import{X as we}from"./x-circle-MQqDWFsw.js";import{M as Ue}from"./message-square-BY9VhxYt.js";import{P as Ce}from"./phone-D5Mv4op6.js";import{P as dt}from"./pen-square-XPG_rn4Q.js";import{F as ot}from"./filter-bwJnrGXq.js";import{E as ct}from"./eye-DISpb38e.js";import{T as mt}from"./trash-2-D2rrIU_x.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=We("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),ut=Ve.injectEndpoints({endpoints:r=>({getReturns:r.query({query:l=>{const d={};return Object.keys(l||{}).forEach(u=>{const f=l[u];f!==""&&f!==null&&f!==void 0&&(d[u]=f)}),{url:"returns",method:"get",params:d}},providesTags:l=>{var d;return(d=l==null?void 0:l.data)!=null&&d.returns||l!=null&&l.data?[...(l.data.returns||l.data).map(({_id:u,id:f})=>({type:"Returns",id:u||f})),{type:"Returns",id:"LIST"}]:[{type:"Returns",id:"LIST"}]}}),getReturn:r.query({query:l=>({url:`returns/${l}`,method:"get"}),providesTags:(l,d,u)=>[{type:"Returns",id:u}]}),createReturn:r.mutation({query:l=>({url:"returns",method:"post",data:l}),invalidatesTags:[{type:"Returns",id:"LIST"}]}),updateReturnStatus:r.mutation({query:({returnId:l,...d})=>({url:`returns/${l}/status`,method:"put",data:d}),invalidatesTags:(l,d,{returnId:u})=>[{type:"Returns",id:u},{type:"Returns",id:"LIST"}]}),updateInspection:r.mutation({query:({returnId:l,...d})=>({url:`returns/${l}/inspection`,method:"put",data:d}),invalidatesTags:(l,d,{returnId:u})=>[{type:"Returns",id:u},{type:"Returns",id:"LIST"}]}),addNote:r.mutation({query:({returnId:l,...d})=>({url:`returns/${l}/notes`,method:"post",data:d}),invalidatesTags:(l,d,{returnId:u})=>[{type:"Returns",id:u}]}),addCommunication:r.mutation({query:({returnId:l,...d})=>({url:`returns/${l}/communication`,method:"post",data:d}),invalidatesTags:(l,d,{returnId:u})=>[{type:"Returns",id:u}]}),getReturnStats:r.query({query:l=>({url:"returns/stats",method:"get",params:l}),providesTags:[{type:"Returns",id:"STATS"}]}),getReturnTrends:r.query({query:l=>({url:"returns/trends",method:"get",params:l}),providesTags:[{type:"Returns",id:"TRENDS"}]}),getEligibleItems:r.query({query:({orderId:l,isPurchase:d=!1})=>({url:d?`returns/purchase-order/${l}/eligible-items`:`returns/order/${l}/eligible-items`,method:"get"}),providesTags:(l,d,{orderId:u})=>[{type:"Returns",id:`ELIGIBLE_${u}`}]}),deleteReturn:r.mutation({query:l=>({url:`returns/${l}`,method:"delete"}),invalidatesTags:(l,d,u)=>[{type:"Returns",id:u},{type:"Returns",id:"LIST"}]})}),overrideExisting:!1}),{useGetReturnsQuery:ht,useGetReturnQuery:He,useCreateReturnMutation:pt,useUpdateReturnStatusMutation:gt,useAddNoteMutation:bt,useAddCommunicationMutation:jt,useGetReturnStatsQuery:ft,useGetEligibleItemsQuery:yt,useDeleteReturnMutation:Nt}=ut,vt=({isOpen:r,onClose:l,onSuccess:d,defaultReturnType:u="sales"})=>{var ce;const f=u==="purchase",[x,N]=R.useState({originalOrder:"",returnType:"return",priority:"normal",refundMethod:"original_payment",items:[],generalNotes:"",origin:u}),[c,v]=R.useState(null),[S,w]=R.useState(""),[te,I]=R.useState(!1),{data:C,isLoading:E}=Xe({search:S,limit:10},{skip:f||S.length<1}),{data:k,isLoading:G}=Ze({search:S,limit:10},{skip:f||S.length<1}),{data:b,isLoading:le}=Je({search:S,limit:10},{skip:!f||S.length<1}),se=f?le:E||G,{data:q,isLoading:ie}=yt(c!=null&&c._id?{orderId:c._id,isPurchase:f}:null,{skip:!(c!=null&&c._id)}),[de,{isLoading:z}]=pt();R.useEffect(()=>{r&&(N({originalOrder:"",returnType:"return",priority:"normal",refundMethod:"original_payment",items:[],generalNotes:"",origin:u}),v(null),w(""),I(!1))},[r,u]);const P=t=>{v(t),N(a=>({...a,originalOrder:t._id})),I(!1),w("")},M=(t,a)=>{const j=t.price||t.unitPrice||t.unitCost||t.totalCost/(t.quantity||1)||0,y={product:t.product._id,originalOrderItem:t._id,quantity:1,originalPrice:j,returnReason:"changed_mind",condition:"good",action:"refund",returnReasonDetail:"",refundAmount:0,restockingFee:0};N(g=>({...g,items:[...g.items,{...y,maxQuantity:a}]}))},Re=t=>{N(a=>({...a,items:a.items.filter((j,y)=>y!==t)}))},m=(t,a,j)=>{N(y=>({...y,items:y.items.map((g,A)=>A===t?{...g,[a]:j}:g)}))},h=async t=>{if(t.preventDefault(),!c){Ne("Please select an order");return}if(x.items.length===0){Ne("Please add at least one item to return");return}for(const a of x.items){if(!a.returnReason){Ne("Please select a return reason for all items");return}if(!a.condition){Ne("Please select a condition for all items");return}if(a.quantity<1||a.quantity>a.maxQuantity){Ne("Invalid quantity for one or more items");return}}try{await de(x).unwrap(),ve("Return request created successfully"),d()}catch(a){me(a,"Create Return")}},oe=R.useMemo(()=>{var g,A,_;if(f)return b?((g=b.data)==null?void 0:g.purchaseInvoices)||b.purchaseInvoices||b.data||[]:[];const t=(C==null?void 0:C.items)||((A=C==null?void 0:C.data)==null?void 0:A.items)||(C==null?void 0:C.data)||[],a=((_=k==null?void 0:k.data)==null?void 0:_.salesOrders)||(k==null?void 0:k.salesOrders)||(k==null?void 0:k.data)||[];return[...t,...a].filter((F,n,p)=>n===p.findIndex(o=>o._id===F._id))},[C,k,b,f]),ae=((ce=q==null?void 0:q.data)==null?void 0:ce.eligibleItems)||(q==null?void 0:q.eligibleItems)||[];return r?e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsxs("div",{className:`relative top-20 mx-auto p-0 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white flex flex-col ${c?"max-h-[90vh]":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Return Request"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{className:"h-6 w-6"})})]}),e.jsx("div",{className:`${c?"overflow-y-auto flex-1":""} p-5`,children:e.jsxs("form",{id:"return-form",onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Original Order *"}),c?e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:c.orderNumber||c.soNumber||c.invoiceNumber||c.poNumber||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:(()=>{var A,_,F;const t=c.supplier||((A=c.purchaseInvoice)==null?void 0:A.supplier),a=c.customer||((_=c.salesOrder)==null?void 0:_.customer),j=f?(t==null?void 0:t.companyName)||(t==null?void 0:t.name)||(t==null?void 0:t.businessName)||((F=t==null?void 0:t.contactPerson)==null?void 0:F.name)||"Unknown supplier":(a==null?void 0:a.businessName)||[a==null?void 0:a.firstName,a==null?void 0:a.lastName].filter(Boolean).join(" ")||(a==null?void 0:a.email)||"Unknown customer",y=c.total??c.grandTotal??c.amount??0,g=c.createdAt||c.invoiceDate||c.orderDate;return`${j} • $${y.toFixed(2)} • ${g?new Date(g).toLocaleDateString():"—"}`})()})]}),e.jsx("button",{type:"button",onClick:()=>{v(null),N(t=>({...t,originalOrder:""}))},className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{className:"h-4 w-4"})})]})}):e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:f?"Search purchase orders by order number, supplier name...":"Search orders by order number, customer name...",value:S,onChange:t=>{w(t.target.value),I(!0)},onFocus:()=>I(!0),className:"input pl-10"}),te&&S&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none",children:se?e.jsx("div",{className:"px-4 py-2 text-gray-500",children:"Searching..."}):oe.length===0?e.jsx("div",{className:"px-4 py-2 text-gray-500",children:"No orders found"}):oe.map(t=>{var F,n,p;const a=t.supplier||((F=t.purchaseInvoice)==null?void 0:F.supplier),j=t.customer||((n=t.salesOrder)==null?void 0:n.customer),y=f?(a==null?void 0:a.companyName)||(a==null?void 0:a.name)||(a==null?void 0:a.businessName)||((p=a==null?void 0:a.contactPerson)==null?void 0:p.name)||"Unknown supplier":(j==null?void 0:j.businessName)||[j==null?void 0:j.firstName,j==null?void 0:j.lastName].filter(Boolean).join(" ")||(j==null?void 0:j.email)||"Unknown customer",g=t.total??t.grandTotal??t.amount??0,A=t.createdAt||t.invoiceDate||t.orderDate,_=t.orderNumber||t.soNumber||t.invoiceNumber||t.poNumber||"N/A";return e.jsx("button",{type:"button",onClick:()=>P(t),className:"w-full text-left px-4 py-2 hover:bg-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("span",{className:"text-sm text-gray-500",children:A?new Date(A).toLocaleDateString():"—"}),e.jsx("span",{className:"font-medium flex-1",children:y}),e.jsx("span",{className:"text-sm text-gray-600",children:_}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["$",g.toFixed(2)]})]})},t._id)})})]})]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Return Type *"}),e.jsxs("select",{value:x.returnType,onChange:t=>N(a=>({...a,returnType:t.target.value})),className:"input",required:!0,children:[e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"exchange",children:"Exchange"}),e.jsx("option",{value:"warranty",children:"Warranty"}),e.jsx("option",{value:"recall",children:"Recall"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:x.priority,onChange:t=>N(a=>({...a,priority:t.target.value})),className:"input",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Items to Return *"}),ie?e.jsx(xe,{message:"Loading eligible items..."}):ae.length===0?e.jsxs("div",{className:"p-4 text-center text-gray-500 bg-gray-50 rounded-lg",children:[e.jsx(Ae,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),e.jsx("p",{children:"No items are eligible for return from this order"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Available Items"}),e.jsx("div",{className:"space-y-2",children:ae.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:t.orderItem.product.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available: ",t.availableQuantity," • Price: $",(t.orderItem.price||t.orderItem.unitPrice||t.orderItem.unitCost||0).toFixed(2)]})]}),e.jsxs("button",{type:"button",onClick:()=>M(t.orderItem,t.availableQuantity),className:"btn btn-primary btn-sm",disabled:x.items.some(j=>j.originalOrderItem===t.orderItem._id),children:[e.jsx(Se,{className:"h-4 w-4 mr-1"}),"Add"]})]},t.orderItem._id))})]}),x.items.length>0&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Selected Items"}),e.jsx("div",{className:"space-y-4",children:x.items.map((t,a)=>{var j;return e.jsxs("div",{className:"p-3 bg-gray-50 rounded border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:(j=ae.find(y=>y.orderItem._id===t.originalOrderItem))==null?void 0:j.orderItem.product.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Max quantity: ",t.maxQuantity]})]}),e.jsx("button",{type:"button",onClick:()=>Re(a),className:"text-red-500 hover:text-red-700",children:e.jsx(Ke,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Quantity *"}),e.jsx("input",{type:"number",min:"1",max:t.maxQuantity,value:t.quantity,onChange:y=>m(a,"quantity",parseInt(y.target.value)||1),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Return Reason *"}),e.jsxs("select",{value:t.returnReason,onChange:y=>m(a,"returnReason",y.target.value),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select reason"}),e.jsx("option",{value:"defective",children:"Defective"}),e.jsx("option",{value:"wrong_item",children:"Wrong Item"}),e.jsx("option",{value:"not_as_described",children:"Not as Described"}),e.jsx("option",{value:"damaged_shipping",children:"Damaged in Shipping"}),e.jsx("option",{value:"changed_mind",children:"Changed Mind"}),e.jsx("option",{value:"duplicate_order",children:"Duplicate Order"}),e.jsx("option",{value:"size_issue",children:"Size Issue"}),e.jsx("option",{value:"quality_issue",children:"Quality Issue"}),e.jsx("option",{value:"late_delivery",children:"Late Delivery"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Condition *"}),e.jsxs("select",{value:t.condition,onChange:y=>m(a,"condition",y.target.value),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select condition"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"like_new",children:"Like New"}),e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"}),e.jsx("option",{value:"damaged",children:"Damaged"})]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Return Reason Details"}),e.jsx("textarea",{value:t.returnReasonDetail,onChange:y=>m(a,"returnReasonDetail",y.target.value),placeholder:"Additional details about the return reason...",className:"input",rows:2})]})]},a)})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refund Method"}),e.jsxs("select",{value:x.refundMethod,onChange:t=>N(a=>({...a,refundMethod:t.target.value})),className:"input",children:[e.jsx("option",{value:"original_payment",children:"Original Payment Method"}),e.jsx("option",{value:"store_credit",children:"Store Credit"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:x.generalNotes,onChange:t=>N(a=>({...a,generalNotes:t.target.value})),placeholder:"Additional notes about this return request...",className:"input",rows:3})]})]})]})}),c&&e.jsxs("div",{className:"flex justify-end space-x-3 p-5 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:l,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",form:"return-form",disabled:z||!c||x.items.length===0,className:"btn btn-primary",children:z?e.jsx(xe,{size:"sm"}):"Create Return Request"})]})]})}):null},wt=({return:r,isOpen:l,onClose:d,onStatusUpdate:u,onAddNote:f,onAddCommunication:x,isLoading:N})=>{var F,n,p,o,D,ne,Q,B,Y,H,W,V,X;const[c,v]=R.useState("details"),[S,w]=R.useState(!1),[te,I]=R.useState(!1),[C,E]=R.useState(!1),[k,G]=R.useState(""),[b,le]=R.useState(""),[se,q]=R.useState(""),[ie,de]=R.useState(!1),[z,P]=R.useState({type:"email",message:"",recipient:""}),{data:M,isLoading:Re}=He(r==null?void 0:r._id,{skip:!(r!=null&&r._id)||!l}),{data:m}=Be(),h=(M==null?void 0:M.data)||M||r,oe=s=>{switch(s){case"pending":return e.jsx($e,{className:"h-5 w-5 text-yellow-500"});case"approved":return e.jsx(K,{className:"h-5 w-5 text-blue-500"});case"rejected":return e.jsx(we,{className:"h-5 w-5 text-red-500"});case"processing":return e.jsx(ee,{className:"h-5 w-5 text-blue-500"});case"received":return e.jsx(ee,{className:"h-5 w-5 text-green-500"});case"completed":return e.jsx(K,{className:"h-5 w-5 text-green-600"});case"cancelled":return e.jsx(we,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(Ae,{className:"h-5 w-5 text-gray-500"})}},ae=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"rejected":return"bg-red-100 text-red-800";case"processing":return"bg-blue-100 text-blue-800";case"received":return"bg-green-100 text-green-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ce=s=>{switch(s){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},t=()=>{u(k,b),w(!1),G(""),le("")},a=()=>{f(se,ie),I(!1),q(""),de(!1)},j=()=>{x(z.type,z.message,z.recipient),E(!1),P({type:"email",message:"",recipient:""})},y=()=>{var J,ue,he,pe,ge,be,je,$,L,fe,ye,Te,De,Pe,_e,Fe,Le,ze;const s=window.open("","_blank"),i=h,Z=((J=m==null?void 0:m.data)==null?void 0:J.companyName)||(m==null?void 0:m.companyName)||"Your Company Name",re=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Return Document - ${i.returnNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 10px; font-size: 12px; }
          .header { text-align: center; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
          .company-name { font-size: 16px; font-weight: bold; color: #333; }
          .document-title { font-size: 14px; color: #666; margin-top: 5px; }
          .return-info { margin-bottom: 15px; }
          .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; border-bottom: 1px solid #eee; font-size: 11px; }
          .info-label { font-weight: bold; color: #333; }
          .info-value { color: #666; }
          .items-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 10px; }
          .items-table th, .items-table td { border: 1px solid #ddd; padding: 4px; text-align: left; }
          .items-table th { background-color: #f5f5f5; font-weight: bold; font-size: 10px; }
          .items-table tr:nth-child(even) { background-color: #f9f9f9; }
          .totals { margin-top: 15px; text-align: right; }
          .total-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; font-size: 11px; }
          .total-label { font-weight: bold; }
          .total-value { font-weight: bold; font-size: 12px; }
          .footer { margin-top: 20px; text-align: center; color: #666; font-size: 10px; }
          @media print {
            body { margin: 5px; font-size: 10px; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">${Z}</div>
          <div class="company-details" style="font-size: 10px; color: #666; margin-top: 5px;">
            ${((ue=m==null?void 0:m.data)==null?void 0:ue.address)||(m==null?void 0:m.address)||""} | ${((he=m==null?void 0:m.data)==null?void 0:he.contactNumber)||(m==null?void 0:m.contactNumber)||""} | ${((pe=m==null?void 0:m.data)==null?void 0:pe.email)||(m==null?void 0:m.email)||""}
          </div>
          <div class="document-title">RETURN DOCUMENT</div>
        </div>
        
        <div class="return-info" style="display: flex; gap: 20px; margin-bottom: 15px;">
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">CUSTOMER DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Customer Name:</span>
              <span class="info-value">${(ge=i.customer)!=null&&ge.firstName&&((be=i.customer)!=null&&be.lastName)?`${i.customer.firstName} ${i.customer.lastName}`:((je=i.customer)==null?void 0:je.name)||(($=i.customer)==null?void 0:$.businessName)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email:</span>
              <span class="info-value">${((L=i.customer)==null?void 0:L.email)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone:</span>
              <span class="info-value">${((fe=i.customer)==null?void 0:fe.phone)||"N/A"}</span>
            </div>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">RETURN DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Return Number:</span>
              <span class="info-value">${i.returnNumber}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Original Order:</span>
              <span class="info-value">${((ye=i.originalOrder)==null?void 0:ye.orderNumber)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Status:</span>
              <span class="info-value">${((Te=i.status)==null?void 0:Te.toUpperCase())||"PENDING"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Priority:</span>
              <span class="info-value">${((De=i.priority)==null?void 0:De.toUpperCase())||"NORMAL"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Return Date:</span>
              <span class="info-value">${new Date(i.returnDate).toLocaleDateString()}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Refund Method:</span>
              <span class="info-value">${((Pe=i.refundMethod)==null?void 0:Pe.replace("_"," ").toUpperCase())||"ORIGINAL PAYMENT"}</span>
            </div>
          </div>
        </div>
        
        <table class="items-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Quantity</th>
              <th>Original Price</th>
              <th>Return Reason</th>
              <th>Condition</th>
              <th>Refund Amount</th>
              <th>Restocking Fee</th>
            </tr>
          </thead>
          <tbody>
            ${((_e=i.items)==null?void 0:_e.map(T=>{var U,Me,Oe;return`
              <tr>
                <td>${((U=T.product)==null?void 0:U.name)||"N/A"}</td>
                <td>${T.quantity||0}</td>
                <td>$${(T.originalPrice||0).toFixed(2)}</td>
                <td>${((Me=T.returnReason)==null?void 0:Me.replace("_"," ").toUpperCase())||"N/A"}</td>
                <td>${((Oe=T.condition)==null?void 0:Oe.toUpperCase())||"N/A"}</td>
                <td>$${(T.refundAmount||0).toFixed(2)}</td>
                <td>$${(T.restockingFee||0).toFixed(2)}</td>
              </tr>
            `}).join(""))||'<tr><td colspan="7">No items found</td></tr>'}
          </tbody>
        </table>
        
        <div class="totals">
          <div class="total-row">
            <span class="total-label">Total Refund Amount:</span>
            <span class="total-value">$${i.totalRefundAmount?i.totalRefundAmount.toFixed(2):i.items?i.items.reduce((T,U)=>T+(U.refundAmount||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Total Restocking Fee:</span>
            <span class="total-value">$${i.totalRestockingFee?i.totalRestockingFee.toFixed(2):i.items?i.items.reduce((T,U)=>T+(U.restockingFee||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Net Refund Amount:</span>
            <span class="total-value">$${i.netRefundAmount?i.netRefundAmount.toFixed(2):i.items?(i.items.reduce((T,U)=>T+(U.refundAmount||0),0)-i.items.reduce((T,U)=>T+(U.restockingFee||0),0)).toFixed(2):"0.00"}</span>
          </div>
        </div>
        
        ${i.generalNotes?`
          <div style="margin-top: 30px;">
            <h3 style="color: #333; margin-bottom: 10px;">Notes:</h3>
            <p style="color: #666; line-height: 1.5;">${i.generalNotes}</p>
          </div>
        `:""}
        
        <div class="footer">
          <p>Generated on ${new Date().toLocaleString()}</p>
          <p>This is a computer-generated document.</p>
          <p style="margin-top: 10px; font-weight: bold;">${Z}</p>
          <p>${((Fe=m==null?void 0:m.data)==null?void 0:Fe.address)||""}</p>
          <p>Phone: ${((Le=m==null?void 0:m.data)==null?void 0:Le.contactNumber)||""} | Email: ${((ze=m==null?void 0:m.data)==null?void 0:ze.email)||""}</p>
        </div>
      </body>
      </html>
    `;s.document.write(re),s.document.close(),s.onload=()=>{s.print(),s.close()}},g=s=>{switch(s){case"pending":return["approved","rejected"];case"approved":return["processing","rejected"];case"processing":return["received","rejected"];case"received":return["completed","rejected"];default:return[]}};if(!l||!h)return null;const A=[{id:"details",label:"Details",icon:Ee},{id:"items",label:"Items",icon:ee},{id:"notes",label:"Notes",icon:Ue},{id:"communication",label:"Communication",icon:Ce}],_=g(h.status);return e.jsxs("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:[e.jsxs("div",{className:"relative top-10 mx-auto p-5 border w-11/12 max-w-6xl shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-medium text-gray-900",children:["Return ",h.returnNumber]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",new Date(h.returnDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600",title:"Print Return Document",children:e.jsx(Ye,{className:"h-6 w-6"})}),e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{className:"h-6 w-6"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${ae(h.status)}`,children:[oe(h.status),e.jsx("span",{className:"ml-2 capitalize",children:h.status})]}),e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${ce(h.priority)}`,children:[h.priority||"normal"," priority"]})]}),_.length>0&&e.jsx("div",{className:"flex space-x-2",children:_.map(s=>e.jsxs("button",{onClick:()=>{G(s),w(!0)},disabled:N,className:`btn btn-sm ${s==="approved"||s==="completed"?"btn-primary":s==="rejected"?"btn-danger":"btn-secondary"}`,children:[s==="approved"&&e.jsx(K,{className:"h-4 w-4 mr-1"}),s==="rejected"&&e.jsx(we,{className:"h-4 w-4 mr-1"}),s==="processing"&&e.jsx(ee,{className:"h-4 w-4 mr-1"}),s==="received"&&e.jsx(ee,{className:"h-4 w-4 mr-1"}),s==="completed"&&e.jsx(K,{className:"h-4 w-4 mr-1"}),s.charAt(0).toUpperCase()+s.slice(1)]},s))})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:A.map(s=>{const i=s.icon;return e.jsxs("button",{onClick:()=>v(s.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm ${c===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(i,{className:"h-4 w-4 mr-2"}),s.label]},s.id)})})}),e.jsxs("div",{className:"min-h-[400px]",children:[c==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Customer Information"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(qe,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[(F=h.customer)==null?void 0:F.firstName," ",(n=h.customer)==null?void 0:n.lastName]}),e.jsx("div",{className:"text-sm text-gray-500",children:(p=h.customer)==null?void 0:p.email})]})]}),((o=h.customer)==null?void 0:o.phone)&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ce,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{children:h.customer.phone})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Order Information"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ee,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(D=h.originalOrder)==null?void 0:D.orderNumber}),e.jsx("div",{className:"text-sm text-gray-500",children:"Original order"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(et,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{children:new Date((ne=h.originalOrder)==null?void 0:ne.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Qe,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsxs("span",{children:["$",(B=(Q=h.originalOrder)==null?void 0:Q.total)==null?void 0:B.toFixed(2)]})]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Return Details"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Return Type"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:h.returnType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Refund Method"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:(Y=h.refundMethod)==null?void 0:Y.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Refund"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:["$",((H=h.netRefundAmount)==null?void 0:H.toFixed(2))||"0.00"]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Timeline"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx($e,{className:"h-4 w-4 text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Return Requested"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(h.returnDate).toLocaleString()})]})]}),h.approvalDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(K,{className:"h-4 w-4 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Approved"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(h.approvalDate).toLocaleString()})]})]}),h.completionDate&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"h-8 w-8 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(K,{className:"h-4 w-4 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Completed"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(h.completionDate).toLocaleString()})]})]})]})})]})]}),c==="items"&&e.jsx("div",{className:"space-y-4",children:(W=h.items)==null?void 0:W.map((s,i)=>{var Z,re,J;return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:(Z=s.product)==null?void 0:Z.name})}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Return Reason"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:(re=s.returnReason)==null?void 0:re.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Condition"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900 capitalize",children:s.condition})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Refund Amount"}),e.jsxs("p",{className:"mt-1 text-sm font-semibold text-gray-900",children:["$",((J=s.refundAmount)==null?void 0:J.toFixed(2))||"0.00"]})]})]}),s.returnReasonDetail&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Reason Details"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:s.returnReasonDetail})]})]})]},i)})}),c==="notes"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Notes"}),e.jsxs("button",{onClick:()=>I(!0),className:"btn btn-primary btn-sm",children:[e.jsx(dt,{className:"h-4 w-4 mr-1"}),"Add Note"]})]}),((V=h.notes)==null?void 0:V.length)>0?e.jsx("div",{className:"space-y-3",children:h.notes.map((s,i)=>e.jsxs("div",{className:`p-3 rounded-lg ${s.isInternal?"bg-blue-50":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-sm text-gray-900",children:s.note}),e.jsx("div",{className:"text-xs text-gray-500 ml-3",children:new Date(s.addedAt).toLocaleDateString()})]}),s.addedBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Added by ",s.addedBy.firstName," ",s.addedBy.lastName,s.isInternal&&" (Internal)"]})]},i))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ue,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No notes added yet"})]})]}),c==="communication"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Communication Log"}),e.jsxs("button",{onClick:()=>E(!0),className:"btn btn-primary btn-sm",children:[e.jsx(xt,{className:"h-4 w-4 mr-1"}),"Log Communication"]})]}),((X=h.communication)==null?void 0:X.length)>0?e.jsx("div",{className:"space-y-3",children:h.communication.map((s,i)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[s.type==="email"&&e.jsx(tt,{className:"h-4 w-4 text-gray-400"}),s.type==="phone"&&e.jsx(Ce,{className:"h-4 w-4 text-gray-400"}),s.type==="in_person"&&e.jsx(qe,{className:"h-4 w-4 text-gray-400"}),s.type==="system"&&e.jsx(Ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:s.type.replace("_"," ")}),s.recipient&&e.jsxs("span",{className:"text-sm text-gray-500",children:["to ",s.recipient]})]}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:s.message})]}),e.jsx("div",{className:"text-xs text-gray-500 ml-3",children:new Date(s.sentAt).toLocaleDateString()})]}),s.sentBy&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Sent by ",s.sentBy.firstName," ",s.sentBy.lastName]})]},i))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ce,{className:"mx-auto h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{children:"No communication logged yet"})]})]})]}),e.jsx("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:e.jsx("button",{onClick:d,className:"btn btn-secondary",children:"Close"})})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-medium text-gray-900",children:["Update Status to ",k.charAt(0).toUpperCase()+k.slice(1)]}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:b,onChange:s=>le(s.target.value),placeholder:"Add any notes about this status change...",className:"input",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>w(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:t,disabled:N,className:`btn ${k==="approved"||k==="completed"?"btn-primary":k==="rejected"?"btn-danger":"btn-secondary"}`,children:N?e.jsx(xe,{size:"sm"}):"Update Status"})]})]})}),te&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Add Note"}),e.jsx("button",{onClick:()=>I(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),e.jsx("textarea",{value:se,onChange:s=>q(s.target.value),placeholder:"Enter your note...",className:"input",rows:4,required:!0})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:ie,onChange:s=>de(s.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Internal note (not visible to customer)"})]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:a,disabled:N||!se.trim(),className:"btn btn-primary",children:N?e.jsx(xe,{size:"sm"}):"Add Note"})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-60",children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:"Log Communication"}),e.jsx("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(O,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),e.jsxs("select",{value:z.type,onChange:s=>P(i=>({...i,type:s.target.value})),className:"input",children:[e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"phone",children:"Phone"}),e.jsx("option",{value:"in_person",children:"In Person"}),e.jsx("option",{value:"system",children:"System"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:z.message,onChange:s=>P(i=>({...i,message:s.target.value})),placeholder:"Enter communication details...",className:"input",rows:4,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recipient (Optional)"}),e.jsx("input",{type:"text",value:z.recipient,onChange:s=>P(i=>({...i,recipient:s.target.value})),placeholder:"e.g., customer email or phone",className:"input"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>E(!1),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:N||!z.message.trim(),className:"btn btn-primary",children:N?e.jsx(xe,{size:"sm"}):"Log Communication"})]})]})})]})},ke=({title:r,value:l,icon:d,color:u="blue",subtitle:f,trend:x})=>{const N={blue:"bg-blue-50 text-blue-600",green:"bg-green-50 text-green-600",yellow:"bg-yellow-50 text-yellow-600",red:"bg-red-50 text-red-600",purple:"bg-purple-50 text-purple-600",indigo:"bg-indigo-50 text-indigo-600",pink:"bg-pink-50 text-pink-600",gray:"bg-gray-50 text-gray-600"};return e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`p-3 rounded-md ${N[u]}`,children:d})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:r}),e.jsxs("dd",{className:"flex items-baseline",children:[e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:l}),x&&e.jsxs("div",{className:`ml-2 flex items-baseline text-sm font-semibold ${x.direction==="up"?"text-green-600":"text-red-600"}`,children:[x.direction==="up"?e.jsx("svg",{className:"self-center flex-shrink-0 h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 9.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 7.414V15a1 1 0 11-2 0V7.414L6.707 9.707a1 1 0 01-1.414 0z",clipRule:"evenodd"})}):e.jsx("svg",{className:"self-center flex-shrink-0 h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M14.707 10.293a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 111.414-1.414L9 12.586V5a1 1 0 012 0v7.586l2.293-2.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e.jsxs("span",{className:"sr-only",children:[x.direction==="up"?"Increased":"Decreased"," by"]}),x.percentage,"%"]})]}),f&&e.jsx("dd",{className:"text-sm text-gray-500",children:f})]})})]})})})},Rt=({filters:r,onFilterChange:l,isLoading:d})=>{const[u,f]=R.useState(!1),x=(v,S)=>{l({[v]:S})},N=()=>{l({status:"",returnType:"",priority:"",search:"",startDate:"",endDate:"",page:1})},c=r.status||r.returnType||r.priority||r.search||r.startDate||r.endDate;return e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"}),c&&e.jsxs("button",{onClick:N,className:"text-sm text-gray-500 hover:text-gray-700 flex items-center",children:[e.jsx(O,{className:"h-4 w-4 mr-1"}),"Clear filters"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Return #, customer...",value:r.search,onChange:v=>x("search",v.target.value),className:"input pl-10",disabled:d})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:r.status,onChange:v=>x("status",v.target.value),className:"input",disabled:d,children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"received",children:"Received"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs("select",{value:r.returnType,onChange:v=>x("returnType",v.target.value),className:"input",disabled:d,children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"return",children:"Return"}),e.jsx("option",{value:"exchange",children:"Exchange"}),e.jsx("option",{value:"warranty",children:"Warranty"}),e.jsx("option",{value:"recall",children:"Recall"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:r.priority,onChange:v=>x("priority",v.target.value),className:"input",disabled:d,children:[e.jsx("option",{value:"",children:"All Priorities"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("button",{onClick:()=>f(!u),className:"flex items-center text-sm text-gray-600 hover:text-gray-800",children:[e.jsx(ot,{className:"h-4 w-4 mr-2"}),u?"Hide":"Show"," Advanced Filters"]}),u&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:r.startDate,onChange:v=>x("startDate",v.target.value),className:"input",disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:r.endDate,onChange:v=>x("endDate",v.target.value),className:"input",disabled:d})]})]})]}),c&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[r.status&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Status: ",r.status,e.jsx("button",{onClick:()=>x("status",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-blue-400 hover:bg-blue-200 hover:text-blue-500",children:e.jsx(O,{className:"h-3 w-3"})})]}),r.returnType&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Type: ",r.returnType,e.jsx("button",{onClick:()=>x("returnType",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-green-400 hover:bg-green-200 hover:text-green-500",children:e.jsx(O,{className:"h-3 w-3"})})]}),r.priority&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:["Priority: ",r.priority,e.jsx("button",{onClick:()=>x("priority",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-orange-400 hover:bg-orange-200 hover:text-orange-500",children:e.jsx(O,{className:"h-3 w-3"})})]}),r.search&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["Search: ",r.search,e.jsx("button",{onClick:()=>x("search",""),className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-purple-400 hover:bg-purple-200 hover:text-purple-500",children:e.jsx(O,{className:"h-3 w-3"})})]}),(r.startDate||r.endDate)&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["Date: ",r.startDate||"Start"," - ",r.endDate||"End",e.jsx("button",{onClick:()=>{x("startDate",""),x("endDate","")},className:"ml-1.5 inline-flex items-center justify-center w-4 h-4 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-500",children:e.jsx(O,{className:"h-3 w-3"})})]})]})]})})},Ot=()=>{var _,F;const[r,l]=R.useState({page:1,limit:10,status:"",returnType:"",priority:"",search:"",startDate:"",endDate:""}),[d,u]=R.useState(null),[f,x]=R.useState(!1),[N,c]=R.useState("sales"),[v,S]=R.useState(!1);st();const{data:w,isLoading:te,error:I,refetch:C}=ht(r,{onError:n=>{me(n,"Fetch Returns")}}),{data:E,isLoading:k}=ft(r.startDate&&r.endDate?{startDate:r.startDate,endDate:r.endDate}:{}),{data:G}=Be(),b=(G==null?void 0:G.data)||G,[le]=gt(),[se]=Nt(),q=async(n,p,o)=>{try{await le({returnId:n,status:p,notes:o}).unwrap(),ve(`Return status updated to ${p}`),S(!1),u(null),C()}catch(D){me(D,"Update Return Status")}},[ie]=bt(),de=async(n,p,o)=>{try{await ie({returnId:n,note:p,isInternal:o}).unwrap(),ve("Note added successfully"),C()}catch(D){me(D,"Add Note")}},z=async n=>{try{await se(n).unwrap(),ve("Return deleted successfully"),C()}catch(p){me(p,"Delete Return")}},P=n=>{l(p=>({...p,...n,page:1}))},{data:M}=He(d==null?void 0:d._id,{skip:!(d!=null&&d._id)}),Re=n=>{u({_id:n}),S(!0)};at.useEffect(()=>{M!=null&&M.data&&u(M.data)},[M]);const m=async(n,p="")=>{d&&await q(d._id,n,p)},[h]=jt(),oe=async(n,p,o=null)=>{if(d)try{await h({returnId:d._id,type:n,message:p,recipient:o}).unwrap(),ve("Communication logged successfully"),C()}catch(D){me(D,"Add Communication")}},ae=async n=>{window.confirm("Are you sure you want to delete this return? This action cannot be undone.")&&await z(n)},ce=n=>{var Q,B,Y,H,W,V,X,s,i,Z,re,J,ue,he,pe,ge,be,je;const p=window.open("","_blank"),o=n,D=((Q=b==null?void 0:b.data)==null?void 0:Q.companyName)||"Your Company Name",ne=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Return Document - ${o.returnNumber}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 10px; font-size: 12px; }
          .header { text-align: center; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
          .company-name { font-size: 16px; font-weight: bold; color: #333; }
          .document-title { font-size: 14px; color: #666; margin-top: 5px; }
          .return-info { margin-bottom: 15px; }
          .info-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; border-bottom: 1px solid #eee; font-size: 11px; }
          .info-label { font-weight: bold; color: #333; }
          .info-value { color: #666; }
          .items-table { width: 100%; border-collapse: collapse; margin: 10px 0; font-size: 10px; }
          .items-table th, .items-table td { border: 1px solid #ddd; padding: 4px; text-align: left; }
          .items-table th { background-color: #f5f5f5; font-weight: bold; font-size: 10px; }
          .items-table tr:nth-child(even) { background-color: #f9f9f9; }
          .totals { margin-top: 15px; text-align: right; }
          .total-row { display: flex; justify-content: space-between; margin-bottom: 3px; padding: 2px 0; font-size: 11px; }
          .total-label { font-weight: bold; }
          .total-value { font-weight: bold; font-size: 12px; }
          .footer { margin-top: 20px; text-align: center; color: #666; font-size: 10px; }
          @media print {
            body { margin: 5px; font-size: 10px; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company-name">${D}</div>
          <div class="company-details" style="font-size: 10px; color: #666; margin-top: 5px;">
            ${((B=b==null?void 0:b.data)==null?void 0:B.address)||""} | ${((Y=b==null?void 0:b.data)==null?void 0:Y.contactNumber)||""} | ${((H=b==null?void 0:b.data)==null?void 0:H.email)||""}
          </div>
          <div class="document-title">RETURN DOCUMENT</div>
        </div>
        
        <div class="return-info" style="display: flex; gap: 20px; margin-bottom: 15px;">
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">CUSTOMER DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Customer Name:</span>
              <span class="info-value">${(W=o.customer)!=null&&W.firstName&&((V=o.customer)!=null&&V.lastName)?`${o.customer.firstName} ${o.customer.lastName}`:((X=o.customer)==null?void 0:X.name)||((s=o.customer)==null?void 0:s.businessName)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email:</span>
              <span class="info-value">${((i=o.customer)==null?void 0:i.email)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone:</span>
              <span class="info-value">${((Z=o.customer)==null?void 0:Z.phone)||"N/A"}</span>
            </div>
          </div>
          <div style="flex: 1;">
            <h3 style="color: #333; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid #ddd; padding-bottom: 3px;">RETURN DETAILS</h3>
            <div class="info-row">
              <span class="info-label">Return Number:</span>
              <span class="info-value">${o.returnNumber}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Original Order:</span>
              <span class="info-value">${((re=o.originalOrder)==null?void 0:re.orderNumber)||"N/A"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Status:</span>
              <span class="info-value">${((J=o.status)==null?void 0:J.toUpperCase())||"PENDING"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Priority:</span>
              <span class="info-value">${((ue=o.priority)==null?void 0:ue.toUpperCase())||"NORMAL"}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Return Date:</span>
              <span class="info-value">${new Date(o.returnDate).toLocaleDateString()}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Refund Method:</span>
              <span class="info-value">${((he=o.refundMethod)==null?void 0:he.replace("_"," ").toUpperCase())||"ORIGINAL PAYMENT"}</span>
            </div>
          </div>
        </div>
        
        <table class="items-table">
          <thead>
            <tr>
              <th>Product</th>
              <th>Quantity</th>
              <th>Original Price</th>
              <th>Return Reason</th>
              <th>Condition</th>
              <th>Refund Amount</th>
              <th>Restocking Fee</th>
            </tr>
          </thead>
          <tbody>
            ${((pe=o.items)==null?void 0:pe.map($=>{var L,fe,ye;return`
              <tr>
                <td>${((L=$.product)==null?void 0:L.name)||"N/A"}</td>
                <td>${$.quantity||0}</td>
                <td>$${($.originalPrice||0).toFixed(2)}</td>
                <td>${((fe=$.returnReason)==null?void 0:fe.replace("_"," ").toUpperCase())||"N/A"}</td>
                <td>${((ye=$.condition)==null?void 0:ye.toUpperCase())||"N/A"}</td>
                <td>$${($.refundAmount||0).toFixed(2)}</td>
                <td>$${($.restockingFee||0).toFixed(2)}</td>
              </tr>
            `}).join(""))||'<tr><td colspan="7">No items found</td></tr>'}
          </tbody>
        </table>
        
        <div class="totals">
          <div class="total-row">
            <span class="total-label">Total Refund Amount:</span>
            <span class="total-value">$${o.totalRefundAmount?o.totalRefundAmount.toFixed(2):o.items?o.items.reduce(($,L)=>$+(L.refundAmount||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Total Restocking Fee:</span>
            <span class="total-value">$${o.totalRestockingFee?o.totalRestockingFee.toFixed(2):o.items?o.items.reduce(($,L)=>$+(L.restockingFee||0),0).toFixed(2):"0.00"}</span>
          </div>
          <div class="total-row">
            <span class="total-label">Net Refund Amount:</span>
            <span class="total-value">$${o.netRefundAmount?o.netRefundAmount.toFixed(2):o.items?(o.items.reduce(($,L)=>$+(L.refundAmount||0),0)-o.items.reduce(($,L)=>$+(L.restockingFee||0),0)).toFixed(2):"0.00"}</span>
          </div>
        </div>
        
        ${o.generalNotes?`
          <div style="margin-top: 30px;">
            <h3 style="color: #333; margin-bottom: 10px;">Notes:</h3>
            <p style="color: #666; line-height: 1.5;">${o.generalNotes}</p>
          </div>
        `:""}
        
        <div class="footer">
          <p>Generated on ${new Date().toLocaleString()}</p>
          <p>This is a computer-generated document.</p>
          <p style="margin-top: 10px; font-weight: bold;">${D}</p>
          <p>${((ge=b==null?void 0:b.data)==null?void 0:ge.address)||""}</p>
          <p>Phone: ${((be=b==null?void 0:b.data)==null?void 0:be.contactNumber)||""} | Email: ${((je=b==null?void 0:b.data)==null?void 0:je.email)||""}</p>
        </div>
      </body>
      </html>
    `;p.document.write(ne),p.document.close(),p.onload=()=>{p.print(),p.close()}},t=n=>{switch(n){case"pending":return e.jsx($e,{className:"h-4 w-4 text-yellow-500"});case"approved":return e.jsx(K,{className:"h-4 w-4 text-blue-500"});case"rejected":return e.jsx(we,{className:"h-4 w-4 text-red-500"});case"processing":return e.jsx(Ie,{className:"h-4 w-4 text-blue-500"});case"received":return e.jsx(ee,{className:"h-4 w-4 text-green-500"});case"completed":return e.jsx(K,{className:"h-4 w-4 text-green-600"});case"cancelled":return e.jsx(we,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(Ae,{className:"h-4 w-4 text-gray-500"})}},a=n=>{switch(n){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"rejected":return"bg-red-100 text-red-800";case"processing":return"bg-blue-100 text-blue-800";case"received":return"bg-green-100 text-green-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},j=n=>{switch(n){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"normal":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};if(te&&!w)return e.jsx(xe,{message:"Loading returns..."});const y=((_=w==null?void 0:w.data)==null?void 0:_.returns)||(w==null?void 0:w.returns)||[],g=((F=w==null?void 0:w.data)==null?void 0:F.pagination)||(w==null?void 0:w.pagination)||{},A=(E==null?void 0:E.data)||E||{totalReturns:0,pendingReturns:0,totalRefundAmount:0,returnRate:0};return e.jsxs(nt,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Return Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage returns, exchanges, and refunds"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>C(),className:"btn btn-secondary",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs("button",{onClick:()=>{c("sales"),x(!0)},className:"btn btn-primary btn-md",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Create Sales Return"]}),e.jsxs("button",{onClick:()=>{c("purchase"),x(!0)},className:"btn btn-primary btn-md",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Create Purchase Return"]})]})]}),!k&&e.jsxs(rt,{cols:{default:1,md:2,lg:4},gap:6,children:[e.jsx(ke,{title:"Total Returns",value:A.totalReturns||0,icon:e.jsx(ee,{className:"h-5 w-5"}),color:"blue"}),e.jsx(ke,{title:"Pending Returns",value:A.pendingReturns||0,icon:e.jsx($e,{className:"h-5 w-5"}),color:"yellow"}),e.jsx(ke,{title:"Total Refunds",value:`$${(A.totalRefundAmount||0).toFixed(2)}`,icon:e.jsx(Qe,{className:"h-5 w-5"}),color:"green"}),e.jsx(ke,{title:"Return Rate",value:`${(A.returnRate||0).toFixed(1)}%`,icon:e.jsx(lt,{className:"h-5 w-5"}),color:"purple"})]}),e.jsx(Rt,{filters:r,onFilterChange:P,isLoading:te}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Returns"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[g.total||0," total returns"]})]})}),e.jsx("div",{className:"card-content p-0",children:te?e.jsx(it,{rows:5,cols:6}):y.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx(ee,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2",children:"No returns found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or create a new return"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Return #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priority"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(n=>{var p,o,D,ne,Q,B,Y,H,W,V,X,s,i;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:new Date(n.returnDate).toLocaleDateString()}),e.jsx("div",{className:"text-sm text-gray-500",children:new Date(n.returnDate).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.origin==="purchase"?((p=n.supplier)==null?void 0:p.companyName)||((o=n.supplier)==null?void 0:o.name)||((D=n.supplier)==null?void 0:D.businessName)||"N/A":((ne=n.customer)==null?void 0:ne.name)||((Q=n.customer)==null?void 0:Q.businessName)||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:n.origin==="purchase"?((B=n.supplier)==null?void 0:B.email)||"N/A":((Y=n.customer)==null?void 0:Y.email)||"N/A"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:((H=n.originalOrder)==null?void 0:H.orderNumber)||((W=n.originalOrder)==null?void 0:W.soNumber)||((V=n.originalOrder)==null?void 0:V.invoiceNumber)||((X=n.originalOrder)==null?void 0:X.poNumber)||"N/A"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[((s=n.items)==null?void 0:s.length)||0," items"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["$",((i=n.netRefundAmount)==null?void 0:i.toFixed(2))||"0.00"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.returnNumber}),e.jsx("div",{className:"text-sm text-gray-500 capitalize",children:n.returnType})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${a(n.status)}`,children:[t(n.status),e.jsx("span",{className:"ml-1 capitalize",children:n.status})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${j(n.priority)}`,children:n.priority||"normal"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>Re(n._id),className:"text-blue-600 hover:text-blue-900",title:"View Return Details",children:e.jsx(ct,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ce(n),className:"text-gray-600 hover:text-gray-900",title:"Print Return Document",children:e.jsx(Ye,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ae(n._id),className:"text-red-600 hover:text-red-900",title:"Delete Return",disabled:!["pending","cancelled"].includes(n.status),children:e.jsx(mt,{className:"h-4 w-4"})})]})})]},n._id)})})]})})}),g.pages>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>P({page:g.current-1}),disabled:!g.hasPrev,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>P({page:g.current+1}),disabled:!g.hasNext,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:(g.current-1)*r.limit+1})," ","to"," ",e.jsx("span",{className:"font-medium",children:Math.min(g.current*r.limit,g.total)})," ","of"," ",e.jsx("span",{className:"font-medium",children:g.total})," ","results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>P({page:g.current-1}),disabled:!g.hasPrev,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),[...Array(g.pages)].map((n,p)=>e.jsx("button",{onClick:()=>P({page:p+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${g.current===p+1?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:p+1},p+1)),e.jsx("button",{onClick:()=>P({page:g.current+1}),disabled:!g.hasNext,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]})]})]}),f&&e.jsx(vt,{isOpen:f,onClose:()=>x(!1),onSuccess:()=>{x(!1),C()},defaultReturnType:N}),v&&d&&e.jsx(wt,{return:d,isOpen:v,onClose:()=>{S(!1),u(null)},onStatusUpdate:m,onAddNote:de,onAddCommunication:oe,isLoading:!1})]})};export{Ot as default};
