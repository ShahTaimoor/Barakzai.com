import{E as te,aZ as Le,r as C,o as e,b6 as M,X as ae,a3 as V,b2 as Me,am as $e,P as Z,av as L,L as Ie,x as Be,z as Qe,b9 as Te,c as Ue,aj as Ve,aT as Y,ak as Re,s as ke,T as w,aM as T,C as H,R as X,H as ze,w as q,O as Ge,K as qe,az as W,M as We,S as Ye,aA as Ke,Q as U}from"./index-jd7Ax_Ed.js";import{A as Ze}from"./AsyncErrorBoundary-e71BFh1E.js";import{u as He}from"./useMutation-n-l4Ns3H.js";import{F as J}from"./filter-CQLYjJyW.js";import{U as re}from"./user-check-DQxSjRYY.js";import{C as le}from"./check-circle-8oGxTki5.js";import{I as Xe}from"./info-D4lm7fBv.js";import{S as se}from"./star-DDOZYr3u.js";import{D as Je}from"./download-bwqK3ulf.js";import{A as z}from"./alert-circle-yrAHCiEw.js";import{A as es}from"./activity-BHXFDV_3.js";import{P as we}from"./plus-C2o0386P.js";import{E as ss}from"./eye-DMmE8Niy.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=te("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=te("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=te("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),rs=Le.injectEndpoints({endpoints:m=>({generateReport:m.mutation({query:c=>({url:"sales-performance/generate",method:"post",data:c}),invalidatesTags:[{type:"Reports",id:"SALES_PERFORMANCE"}]}),getReports:m.query({query:c=>({url:"sales-performance",method:"get",params:c}),providesTags:c=>{var i,r;return(i=c==null?void 0:c.data)!=null&&i.reports||c!=null&&c.reports?[...(((r=c.data)==null?void 0:r.reports)||c.reports).map(({_id:h,id:o})=>({type:"Reports",id:h||o})),{type:"Reports",id:"SALES_PERFORMANCE"}]:[{type:"Reports",id:"SALES_PERFORMANCE"}]}}),getReport:m.query({query:c=>({url:`sales-performance/${c}`,method:"get"}),providesTags:(c,i,r)=>[{type:"Reports",id:r}]}),deleteReport:m.mutation({query:c=>({url:`sales-performance/${c}`,method:"delete"}),invalidatesTags:(c,i,r)=>[{type:"Reports",id:r},{type:"Reports",id:"SALES_PERFORMANCE"}]}),toggleFavorite:m.mutation({query:({id:c,isFavorite:i})=>({url:`sales-performance/${c}/favorite`,method:"put",data:{isFavorite:i}}),invalidatesTags:(c,i,{id:r})=>[{type:"Reports",id:r}]}),updateTags:m.mutation({query:({id:c,tags:i})=>({url:`sales-performance/${c}/tags`,method:"put",data:{tags:i}}),invalidatesTags:(c,i,{id:r})=>[{type:"Reports",id:r}]}),updateNotes:m.mutation({query:({id:c,notes:i})=>({url:`sales-performance/${c}/notes`,method:"put",data:{notes:i}}),invalidatesTags:(c,i,{id:r})=>[{type:"Reports",id:r}]}),exportReport:m.mutation({query:({id:c,format:i})=>({url:`sales-performance/${c}/export`,method:"post",data:{format:i},responseType:"blob"})}),getReportStats:m.query({query:c=>({url:"sales-performance/stats/overview",method:"get",params:c}),providesTags:[{type:"Reports",id:"SALES_PERFORMANCE_STATS"}]}),getQuickTopProducts:m.query({query:c=>({url:"sales-performance/quick/top-products",method:"get",params:c}),providesTags:[{type:"Reports",id:"SALES_PERFORMANCE_TOP_PRODUCTS"}]}),getQuickTopCustomers:m.query({query:c=>({url:"sales-performance/quick/top-customers",method:"get",params:c}),providesTags:[{type:"Reports",id:"SALES_PERFORMANCE_TOP_CUSTOMERS"}]}),getQuickTopSalesReps:m.query({query:c=>({url:"sales-performance/quick/top-sales-reps",method:"get",params:c}),providesTags:[{type:"Reports",id:"SALES_PERFORMANCE_TOP_SALES_REPS"}]}),getQuickSummary:m.query({query:c=>({url:"sales-performance/quick/summary",method:"get",params:c}),providesTags:[{type:"Reports",id:"SALES_PERFORMANCE_QUICK_SUMMARY"}]})}),overrideExisting:!1}),{useGetReportsQuery:ls,useGetReportQuery:cs,useDeleteReportMutation:ns,useToggleFavoriteMutation:is,useExportReportMutation:ds,useGetQuickTopProductsQuery:os,useGetQuickTopCustomersQuery:Ce,useGetQuickSummaryQuery:ms}=rs,xs=({isOpen:m,onClose:c,onSuccess:i})=>{var S,t,f;const[r,h]=C.useState({reportType:"comprehensive",periodType:"monthly",startDate:"",endDate:"",limit:10,rankBy:"revenue",includeMetrics:{revenue:!0,quantity:!0,profit:!0,margin:!0,orders:!0,averageOrderValue:!0},filters:{orderTypes:[],customerTiers:[],businessTypes:[],productCategories:[],salesReps:[]},groupBy:"product"}),[o,O]=C.useState("basic"),[u,N]=C.useState({}),d=[{id:"basic",label:"Basic Settings",icon:V},{id:"period",label:"Time Period",icon:Me},{id:"filters",label:"Filters",icon:J},{id:"advanced",label:"Advanced",icon:$e}],R=[{value:"top_products",label:"Top Products",icon:Z,description:"Analyze best-performing products"},{value:"top_customers",label:"Top Customers",icon:L,description:"Identify high-value customers"},{value:"top_sales_reps",label:"Top Sales Reps",icon:re,description:"Track sales team performance"},{value:"comprehensive",label:"Comprehensive",icon:M,description:"Complete performance overview"}],k=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"yearly",label:"Yearly"},{value:"custom",label:"Custom Range"}],p=[{value:"retail",label:"Retail"},{value:"wholesale",label:"Wholesale"},{value:"online",label:"Online"}],j=[{value:"bronze",label:"Bronze"},{value:"silver",label:"Silver"},{value:"gold",label:"Gold"},{value:"platinum",label:"Platinum"}],l=[{value:"retail",label:"Retail"},{value:"wholesale",label:"Wholesale"},{value:"distributor",label:"Distributor"}],y=[{value:"product",label:"Product"},{value:"customer",label:"Customer"},{value:"sales_rep",label:"Sales Rep"},{value:"category",label:"Category"},{value:"date",label:"Date"}],b=He(Te.generateReport,{onSuccess:s=>{Qe("Report generation started successfully"),i(s.data.report)},onError:s=>{var x,v;Be(((v=(x=s.response)==null?void 0:x.data)==null?void 0:v.message)||"Failed to create report")}}),n=(s,x)=>{h(v=>({...v,[s]:x})),u[s]&&N(v=>({...v,[s]:""}))},A=(s,x,v)=>{h(I=>({...I,[s]:{...I[s],[x]:v}}))},P=(s,x,v,I)=>{h(B=>({...B,[s]:{...B[s],[x]:I?[...B[s][x],v]:B[s][x].filter(ee=>ee!==v)}}))},$=()=>{const s={};return r.reportType||(s.reportType="Report type is required"),r.periodType||(s.periodType="Period type is required"),r.periodType==="custom"&&(r.startDate||(s.startDate="Start date is required for custom period"),r.endDate||(s.endDate="End date is required for custom period"),r.startDate&&r.endDate&&new Date(r.startDate)>=new Date(r.endDate)&&(s.endDate="End date must be after start date")),(r.limit<1||r.limit>100)&&(s.limit="Limit must be between 1 and 100"),N(s),Object.keys(s).length===0},D=s=>{if(s.preventDefault(),!$())return;const x={...r,startDate:r.periodType==="custom"?r.startDate:void 0,endDate:r.periodType==="custom"?r.endDate:void 0};b.mutate(x)},E=()=>{h({reportType:"comprehensive",periodType:"monthly",startDate:"",endDate:"",limit:10,includeMetrics:{revenue:!0,quantity:!0,profit:!0,margin:!0,orders:!0,averageOrderValue:!0},filters:{orderTypes:[],customerTiers:[],businessTypes:[],productCategories:[],salesReps:[]},groupBy:"product",rankBy:"revenue"}),N({}),O("basic"),c()};return m?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:E})}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create Sales Performance Report"})]}),e.jsx("button",{onClick:E,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:d.map(s=>e.jsxs("button",{onClick:()=>O(s.id),className:`${o===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(s.icon,{className:"h-4 w-4 mr-2"}),s.label]},s.id))})}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"bg-white px-6 py-6 max-h-96 overflow-y-auto",children:[o==="basic"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Report Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:R.map(s=>e.jsx("div",{className:`relative rounded-lg border-2 p-4 cursor-pointer transition-colors ${r.reportType===s.value?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>n("reportType",s.value),children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(s.icon,{className:`h-5 w-5 mr-3 ${r.reportType===s.value?"text-blue-600":"text-gray-400"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`text-sm font-medium ${r.reportType===s.value?"text-blue-900":"text-gray-900"}`,children:s.label}),e.jsx("p",{className:`text-xs mt-1 ${r.reportType===s.value?"text-blue-700":"text-gray-500"}`,children:s.description})]}),r.reportType===s.value&&e.jsx(le,{className:"h-5 w-5 text-blue-600"})]})},s.value))}),u.reportType&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:u.reportType})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Limit Results"}),e.jsx("input",{type:"number",min:"1",max:"100",value:r.limit,onChange:s=>n("limit",parseInt(s.target.value)),className:"input",placeholder:"10"}),u.limit&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:u.limit}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Number of top results to include in the report (1-100)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Include Metrics"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(r.includeMetrics).map(([s,x])=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:v=>A("includeMetrics",s,v.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 capitalize",children:s.replace(/([A-Z])/g," $1").trim()})]},s))})]}),r.reportType==="top_customers"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Customer Ranking Metric"}),e.jsx("div",{className:"flex space-x-3",children:[{value:"revenue",label:"Sales Volume"},{value:"profit",label:"Profitability"}].map(s=>e.jsx("button",{type:"button",onClick:()=>n("rankBy",s.value),className:`px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${r.rankBy===s.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 text-gray-700 hover:border-gray-300"}`,children:s.label},s.value))}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Choose whether to rank customers by total sales or profit."})]})]}),o==="period"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Period Type"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:k.map(s=>e.jsx("button",{type:"button",onClick:()=>n("periodType",s.value),className:`p-3 rounded-lg border text-sm font-medium transition-colors ${r.periodType===s.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 text-gray-700 hover:border-gray-300"}`,children:s.label},s.value))}),u.periodType&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:u.periodType})]}),r.periodType==="custom"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:r.startDate,onChange:s=>n("startDate",s.target.value),className:"input"}),u.startDate&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:u.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:r.endDate,onChange:s=>n("endDate",s.target.value),className:"input"}),u.endDate&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:u.endDate})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Xe,{className:"h-5 w-5 text-blue-400 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-700",children:[e.jsx("p",{className:"font-medium",children:"Period Information"}),e.jsx("p",{className:"mt-1",children:r.periodType==="custom"?"Custom date range selected":`${r.periodType.charAt(0).toUpperCase()+r.periodType.slice(1)} period will be analyzed`})]})]})})]}),o==="filters"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Order Types"}),e.jsx("div",{className:"space-y-2",children:p.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.filters.orderTypes.includes(s.value),onChange:x=>P("filters","orderTypes",s.value,x.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 capitalize",children:s.label})]},s.value))}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Leave empty to include all order types"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Customer Tiers"}),e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.filters.customerTiers.includes(s.value),onChange:x=>P("filters","customerTiers",s.value,x.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 capitalize",children:s.label})]},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Business Types"}),e.jsx("div",{className:"space-y-2",children:l.map(s=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:r.filters.businessTypes.includes(s.value),onChange:x=>P("filters","businessTypes",s.value,x.target.checked),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 capitalize",children:s.label})]},s.value))})]})]}),o==="advanced"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Group By"}),e.jsx("select",{value:r.groupBy,onChange:s=>n("groupBy",s.target.value),className:"input",children:y.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Primary grouping method for the report data"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Report Preview"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",(S=R.find(s=>s.value===r.reportType))==null?void 0:S.label]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Period:"})," ",(t=k.find(s=>s.value===r.periodType))==null?void 0:t.label]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Limit:"})," ",r.limit," results"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Group By:"})," ",(f=y.find(s=>s.value===r.groupBy))==null?void 0:f.label]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:E,className:"btn btn-secondary",children:"Cancel"}),e.jsxs(Ie,{type:"submit",isLoading:b.isLoading,className:"btn btn-primary",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]})]})]})]})}):null},hs=({isOpen:m,onClose:c,report:i,onDelete:r,onExport:h})=>{var $,D,E,S;const[o,O]=C.useState("overview"),[u,N]=C.useState(!1),{data:d,isLoading:R,error:k}=Ue(["salesPerformanceReport",i==null?void 0:i.reportId],()=>Te.getReport(i.reportId),{enabled:!!(i!=null&&i.reportId)&&m,onError:t=>{console.error("Error fetching report details:",t)}}),p=[{id:"overview",label:"Overview",icon:M},{id:"products",label:"Top Products",icon:Z},{id:"customers",label:"Top Customers",icon:L},{id:"salesreps",label:"Top Sales Reps",icon:re},{id:"categories",label:"Categories",icon:Ve},{id:"insights",label:"Insights",icon:K}],j=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),l=t=>`${t>=0?"+":""}${t.toFixed(1)}%`,y=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=t=>{switch(t){case"completed":return e.jsx(le,{className:"h-4 w-4 text-green-600"});case"generating":return e.jsx(X,{className:"h-4 w-4 text-blue-600 animate-spin"});case"failed":return e.jsx(z,{className:"h-4 w-4 text-red-600"});case"archived":return e.jsx(H,{className:"h-4 w-4 text-gray-600"});default:return e.jsx(H,{className:"h-4 w-4 text-gray-600"})}},n=t=>{switch(t){case"completed":return"text-green-600 bg-green-50";case"generating":return"text-blue-600 bg-blue-50";case"failed":return"text-red-600 bg-red-50";case"archived":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},A=t=>{switch(t){case"achievement":return e.jsx(ts,{className:"h-5 w-5 text-green-600"});case"opportunity":return e.jsx(w,{className:"h-5 w-5 text-blue-600"});case"warning":return e.jsx(z,{className:"h-5 w-5 text-yellow-600"});case"recommendation":return e.jsx(K,{className:"h-5 w-5 text-purple-600"});default:return e.jsx(es,{className:"h-5 w-5 text-gray-600"})}},P=t=>{switch(t){case"achievement":return"border-green-200 bg-green-50";case"opportunity":return"border-blue-200 bg-blue-50";case"warning":return"border-yellow-200 bg-yellow-50";case"recommendation":return"border-purple-200 bg-purple-50";default:return"border-gray-200 bg-gray-50"}};return!m||!i?null:e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:c})}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-7xl sm:w-full",children:[e.jsx("div",{className:"bg-white px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-6 w-6 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:i.reportName}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${n(i.status)}`,children:[b(i.status),e.jsx("span",{className:"ml-1 capitalize",children:i.status})]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Generated ",y(i.generatedAt)]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Views: ",i.viewCount||0]}),i.isFavorite&&e.jsx(se,{className:"h-4 w-4 text-yellow-500 fill-current"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>N(!u),className:"btn btn-secondary",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{className:"h-6 w-6"})})]})]})}),u&&e.jsx("div",{className:"absolute right-4 top-16 z-10 bg-white border border-gray-200 rounded-lg shadow-lg",children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{h(i.reportId,"pdf"),N(!1)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Export as PDF"]}),e.jsxs("button",{onClick:()=>{h(i.reportId,"excel"),N(!1)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Export as Excel"]}),e.jsxs("button",{onClick:()=>{h(i.reportId,"csv"),N(!1)},className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Export as CSV"]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:p.map(t=>e.jsxs("button",{onClick:()=>O(t.id),className:`${o===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center`,children:[e.jsx(t.icon,{className:"h-4 w-4 mr-2"}),t.label]},t.id))})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:R?e.jsx("div",{className:"p-6",children:e.jsx(Y,{})}):k?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(z,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error loading report"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:k.message})]}):e.jsxs("div",{className:"p-6",children:[o==="overview"&&d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Re,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j((($=d.summary)==null?void 0:$.totalRevenue)||0)})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ke,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(((D=d.summary)==null?void 0:D.totalOrders)||0).toLocaleString()})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Avg Order Value"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j(((E=d.summary)==null?void 0:E.averageOrderValue)||0)})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Customers"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:(((S=d.summary)==null?void 0:S.totalCustomers)||0).toLocaleString()})]})]})})})]}),d.comparison&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Period Comparison"})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Revenue Change"}),e.jsxs("div",{className:`flex items-center justify-center mt-2 ${d.comparison.changes.revenueChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[d.comparison.changes.revenueChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 mr-1"}):e.jsx(T,{className:"h-4 w-4 mr-1"}),l(d.comparison.changes.revenueChangePercentage)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Orders Change"}),e.jsxs("div",{className:`flex items-center justify-center mt-2 ${d.comparison.changes.orderChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[d.comparison.changes.orderChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 mr-1"}):e.jsx(T,{className:"h-4 w-4 mr-1"}),l(d.comparison.changes.orderChangePercentage)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"AOV Change"}),e.jsxs("div",{className:`flex items-center justify-center mt-2 ${d.comparison.changes.aovChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[d.comparison.changes.aovChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 mr-1"}):e.jsx(T,{className:"h-4 w-4 mr-1"}),l(d.comparison.changes.aovChangePercentage)]})]})]})})]})]}),o==="products"&&(d==null?void 0:d.topProducts)&&e.jsx("div",{className:"space-y-4",children:d.topProducts.map((t,f)=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:["#",f+1]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:t.product.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Category: ",t.product.category||"N/A"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:j(t.metrics.totalRevenue)}),e.jsxs("div",{className:`text-sm ${t.trend.revenueChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[t.trend.revenueChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline mr-1"}):e.jsx(T,{className:"h-4 w-4 inline mr-1"}),l(t.trend.revenueChangePercentage)]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Quantity"}),e.jsx("p",{className:"font-medium",children:t.metrics.totalQuantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Orders"}),e.jsx("p",{className:"font-medium",children:t.metrics.totalOrders})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Profit"}),e.jsx("p",{className:"font-medium",children:j(t.metrics.profit)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Margin"}),e.jsxs("p",{className:"font-medium",children:[t.metrics.margin.toFixed(1),"%"]})]})]})]})},t.product._id))}),o==="customers"&&(d==null?void 0:d.topCustomers)&&e.jsx("div",{className:"space-y-4",children:d.topCustomers.map((t,f)=>{var s;return e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-green-600",children:["#",f+1]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:t.customer.displayName}),e.jsxs("p",{className:"text-sm text-gray-500 capitalize",children:[t.customer.businessType," â€¢ ",t.customer.customerTier]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Revenue"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:j(t.metrics.totalRevenue)}),e.jsxs("div",{className:`text-sm ${t.trend.revenueChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[t.trend.revenueChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline mr-1"}):e.jsx(T,{className:"h-4 w-4 inline mr-1"}),l(t.trend.revenueChangePercentage)]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Profit"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:j(t.metrics.totalProfit)}),e.jsxs("div",{className:`text-sm ${t.trend.profitChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[t.trend.profitChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline mr-1"}):e.jsx(T,{className:"h-4 w-4 inline mr-1"}),l(t.trend.profitChangePercentage)]})]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Orders"}),e.jsx("p",{className:"font-medium",children:t.metrics.totalOrders})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Avg Order Value"}),e.jsx("p",{className:"font-medium",children:j(t.metrics.averageOrderValue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Last Order"}),e.jsx("p",{className:"font-medium",children:y(t.metrics.lastOrderDate)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Margin"}),e.jsxs("p",{className:"font-medium",children:[((s=t.metrics.margin)==null?void 0:s.toFixed(1))||0,"%"]})]})]})]})},t.customer._id)})}),o==="salesreps"&&(d==null?void 0:d.topSalesReps)&&e.jsx("div",{className:"space-y-4",children:d.topSalesReps.map((t,f)=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-purple-600",children:["#",f+1]})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:[t.salesRep.firstName," ",t.salesRep.lastName]}),e.jsx("p",{className:"text-sm text-gray-500",children:t.salesRep.email})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:j(t.metrics.totalRevenue)}),e.jsxs("div",{className:`text-sm ${t.trend.revenueChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[t.trend.revenueChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline mr-1"}):e.jsx(T,{className:"h-4 w-4 inline mr-1"}),l(t.trend.revenueChangePercentage)]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Orders"}),e.jsx("p",{className:"font-medium",children:t.metrics.totalOrders})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Customers"}),e.jsx("p",{className:"font-medium",children:t.metrics.totalCustomers})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Conversion Rate"}),e.jsxs("p",{className:"font-medium",children:[(t.metrics.conversionRate*100).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Avg Order Value"}),e.jsx("p",{className:"font-medium",children:j(t.metrics.averageOrderValue)})]})]})]})},t.salesRep._id))}),o==="insights"&&(d==null?void 0:d.insights)&&e.jsx("div",{className:"space-y-4",children:d.insights.map((t,f)=>e.jsx("div",{className:`border rounded-lg p-4 ${P(t.type)}`,children:e.jsxs("div",{className:"flex items-start",children:[A(t.type),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:t.title}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:t.description}),t.actionable&&t.suggestedActions&&t.suggestedActions.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Suggested Actions:"}),e.jsx("ul",{className:"mt-1 text-sm text-gray-600 list-disc list-inside",children:t.suggestedActions.map((s,x)=>e.jsx("li",{children:s},x))})]})]}),e.jsx("div",{className:"ml-3",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${t.impact==="high"?"bg-red-100 text-red-800":t.impact==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[t.impact," impact"]})})]})},f))})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Report ID: ",i.reportId]}),e.jsx("div",{className:"flex space-x-3",children:e.jsx("button",{onClick:c,className:"btn btn-secondary",children:"Close"})})]})]})]})})},us=({filters:m,onFilterChange:c,onClose:i})=>{const[r,h]=C.useState(m),o=(l,y)=>{const b={...r,[l]:y,page:1};h(b)},O=()=>{c(r)},u=()=>{const l={page:1,limit:10,reportType:"",status:"",generatedBy:"",startDate:"",endDate:"",sortBy:"generatedAt",sortOrder:"desc"};h(l),c(l)},N=()=>{h(m)},d=[{value:"",label:"All Types"},{value:"top_products",label:"Top Products"},{value:"top_customers",label:"Top Customers"},{value:"top_sales_reps",label:"Top Sales Reps"},{value:"comprehensive",label:"Comprehensive"}],R=[{value:"",label:"All Statuses"},{value:"generating",label:"Generating"},{value:"completed",label:"Completed"},{value:"failed",label:"Failed"},{value:"archived",label:"Archived"}],k=[{value:"generatedAt",label:"Date Created"},{value:"reportName",label:"Report Name"},{value:"status",label:"Status"},{value:"viewCount",label:"View Count"}],p=[{value:"desc",label:"Descending"},{value:"asc",label:"Ascending"}],j=[{value:"",label:"All Periods"},{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"},{value:"quarterly",label:"Quarterly"},{value:"yearly",label:"Yearly"},{value:"custom",label:"Custom"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filter Reports"})]}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ae,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Report Type"}),e.jsx("select",{value:r.reportType||"",onChange:l=>o("reportType",l.target.value),className:"input",children:d.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsx("select",{value:r.status||"",onChange:l=>o("status",l.target.value),className:"input",children:R.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Period Type"}),e.jsx("select",{value:r.periodType||"",onChange:l=>o("periodType",l.target.value),className:"input",children:j.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:r.startDate||"",onChange:l=>o("startDate",l.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:r.endDate||"",onChange:l=>o("endDate",l.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Generated By"}),e.jsx("input",{type:"text",placeholder:"Search by user...",value:r.generatedBy||"",onChange:l=>o("generatedBy",l.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),e.jsx("select",{value:r.sortBy||"generatedAt",onChange:l=>o("sortBy",l.target.value),className:"input",children:k.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort Order"}),e.jsx("select",{value:r.sortOrder||"desc",onChange:l=>o("sortOrder",l.target.value),className:"input",children:p.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Results Per Page"}),e.jsxs("select",{value:r.limit||10,onChange:l=>o("limit",parseInt(l.target.value)),className:"input",children:[e.jsx("option",{value:5,children:"5 per page"}),e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:20,children:"20 per page"}),e.jsx("option",{value:50,children:"50 per page"}),e.jsx("option",{value:100,children:"100 per page"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Quick Filters"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>o("status","completed"),className:`px-3 py-1 rounded-full text-xs font-medium ${r.status==="completed"?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200"}`,children:"Completed Only"}),e.jsx("button",{onClick:()=>o("status","generating"),className:`px-3 py-1 rounded-full text-xs font-medium ${r.status==="generating"?"bg-blue-100 text-blue-800 border border-blue-200":"bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200"}`,children:"Generating Only"}),e.jsx("button",{onClick:()=>{const l=new Date,y=new Date(l.getTime()-7*24*60*60*1e3);o("startDate",y.toISOString().split("T")[0]),o("endDate",l.toISOString().split("T")[0])},className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200",children:"Last 7 Days"}),e.jsx("button",{onClick:()=>{const l=new Date,y=new Date(l.getFullYear(),l.getMonth()-1,l.getDate());o("startDate",y.toISOString().split("T")[0]),o("endDate",l.toISOString().split("T")[0])},className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200",children:"Last 30 Days"}),e.jsx("button",{onClick:()=>o("reportType","comprehensive"),className:`px-3 py-1 rounded-full text-xs font-medium ${r.reportType==="comprehensive"?"bg-purple-100 text-purple-800 border border-purple-200":"bg-gray-100 text-gray-700 border border-gray-200 hover:bg-gray-200"}`,children:"Comprehensive Reports"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6 flex justify-between",children:[e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:u,className:"btn btn-secondary",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Clear All"]}),e.jsx("button",{onClick:N,className:"btn btn-secondary",children:"Reset"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:i,className:"btn btn-secondary",children:"Cancel"}),e.jsxs("button",{onClick:O,className:"btn btn-primary",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Apply Filters"]})]})]})]})},Ps=()=>{var ce,ne,ie,de,oe,me,xe,he,ue,pe,ge,je,ye,ve,Ne,be;const[m,c]=C.useState({page:1,limit:10,reportType:"",status:"",generatedBy:"",startDate:"",endDate:"",sortBy:"generatedAt",sortOrder:"desc"}),[i,r]=C.useState(""),[h,o]=C.useState(null),[O,u]=C.useState(!1),[N,d]=C.useState(!1),[R,k]=C.useState(!1);ze();const{data:p,isLoading:j,error:l,refetch:y}=ls(m,{onError:a=>{q(a,"Sales Performance Reports")}}),{data:b}=cs(h==null?void 0:h._id,{skip:!(h!=null&&h._id)}),{data:n,isLoading:A}=ms({period:"30d"},{retry:1,refetchOnFocus:!1}),{data:P,isLoading:$}=os({period:"30d",limit:5},{retry:1,refetchOnFocus:!1}),{data:D,isLoading:E}=Ce({period:"30d",limit:5,metric:"revenue"},{retry:1,refetchOnFocus:!1}),{data:S,isLoading:t}=Ce({period:"30d",limit:5,metric:"profit"},{retry:1,refetchOnFocus:!1}),[f]=ns(),[s]=is(),[x]=ds();Ge.useEffect(()=>{b!=null&&b.data&&o(b.data)},[b]);const v=a=>{c(g=>({...g,...a,page:1}))},I=a=>{r(a),c(g=>({...g,search:a,page:1}))},B=a=>{o(a),d(!0)},ee=async a=>{if(window.confirm("Are you sure you want to delete this report? This action cannot be undone."))try{await f(a).unwrap(),U.success("Report deleted successfully"),y()}catch(g){q(g,"Delete Report")}},Pe=async(a,g)=>{try{await s({id:a,isFavorite:g}).unwrap(),U.success("Favorite status updated"),y()}catch(_){q(_,"Update Favorite")}},Se=async(a,g)=>{try{const _=await x({id:a,format:g}).unwrap(),fe=window.URL.createObjectURL(_),Q=document.createElement("a");Q.href=fe,Q.download=`sales-performance-report-${a}.${g}`,document.body.appendChild(Q),Q.click(),window.URL.revokeObjectURL(fe),document.body.removeChild(Q),U.success(`Report exported as ${g.toUpperCase()} successfully!`)}catch(_){q(_,"Export Report")}},De=()=>{y(),U.success("Data refreshed")},Oe=a=>{switch(a){case"completed":return e.jsx(le,{className:"h-4 w-4 text-green-600"});case"generating":return e.jsx(X,{className:"h-4 w-4 text-blue-600 animate-spin"});case"failed":return e.jsx(z,{className:"h-4 w-4 text-red-600"});case"archived":return e.jsx(H,{className:"h-4 w-4 text-gray-600"});default:return e.jsx(H,{className:"h-4 w-4 text-gray-600"})}},Ae=a=>{switch(a){case"completed":return"text-green-600 bg-green-50";case"generating":return"text-blue-600 bg-blue-50";case"failed":return"text-red-600 bg-red-50";case"archived":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},Ee=a=>{switch(a){case"top_products":return e.jsx(Z,{className:"h-4 w-4"});case"top_customers":return e.jsx(L,{className:"h-4 w-4"});case"top_sales_reps":return e.jsx(re,{className:"h-4 w-4"});case"comprehensive":return e.jsx(M,{className:"h-4 w-4"});default:return e.jsx(V,{className:"h-4 w-4"})}},_e=a=>{switch(a){case"top_products":return"Top Products";case"top_customers":return"Top Customers";case"top_sales_reps":return"Top Sales Reps";case"comprehensive":return"Comprehensive";default:return"Custom"}},F=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),G=a=>`${a>=0?"+":""}${a.toFixed(1)}%`,Fe=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return l?e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(z,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Error loading reports"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:l.message})]})}):e.jsxs(Ze,{children:[e.jsxs(qe,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sales Performance Reports"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Analyze top products, customers, and sales performance"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex space-x-3",children:[e.jsxs("button",{onClick:De,className:"btn btn-secondary",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs("button",{onClick:()=>u(!0),className:"btn btn-primary btn-md",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Create Report"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Re,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Revenue (30d)"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:A?e.jsx(W,{}):F(((ce=n==null?void 0:n.summary)==null?void 0:ce.totalRevenue)||0)}),((ie=(ne=n==null?void 0:n.comparison)==null?void 0:ne.changes)==null?void 0:ie.revenueChangePercentage)!==void 0&&e.jsxs("span",{className:`ml-2 text-sm ${n.comparison.changes.revenueChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[n.comparison.changes.revenueChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline"}):e.jsx(T,{className:"h-4 w-4 inline"}),G(n.comparison.changes.revenueChangePercentage)]})]})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ke,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Orders (30d)"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:A?e.jsx(W,{}):(((de=n==null?void 0:n.summary)==null?void 0:de.totalOrders)||0).toLocaleString()}),((me=(oe=n==null?void 0:n.comparison)==null?void 0:oe.changes)==null?void 0:me.orderChangePercentage)!==void 0&&e.jsxs("span",{className:`ml-2 text-sm ${n.comparison.changes.orderChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[n.comparison.changes.orderChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline"}):e.jsx(T,{className:"h-4 w-4 inline"}),G(n.comparison.changes.orderChangePercentage)]})]})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(K,{className:"h-8 w-8 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Avg Order Value (30d)"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:A?e.jsx(W,{}):F(((xe=n==null?void 0:n.summary)==null?void 0:xe.averageOrderValue)||0)}),((ue=(he=n==null?void 0:n.comparison)==null?void 0:he.changes)==null?void 0:ue.aovChangePercentage)!==void 0&&e.jsxs("span",{className:`ml-2 text-sm ${n.comparison.changes.aovChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[n.comparison.changes.aovChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline"}):e.jsx(T,{className:"h-4 w-4 inline"}),G(n.comparison.changes.aovChangePercentage)]})]})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(L,{className:"h-8 w-8 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Customers (30d)"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:A?e.jsx(W,{}):(((pe=n==null?void 0:n.summary)==null?void 0:pe.totalCustomers)||0).toLocaleString()}),((je=(ge=n==null?void 0:n.comparison)==null?void 0:ge.changes)==null?void 0:je.customerChangePercentage)!==void 0&&e.jsxs("span",{className:`ml-2 text-sm ${n.comparison.changes.customerChangePercentage>=0?"text-green-600":"text-red-600"}`,children:[n.comparison.changes.customerChangePercentage>=0?e.jsx(w,{className:"h-4 w-4 inline"}):e.jsx(T,{className:"h-4 w-4 inline"}),G(n.comparison.changes.customerChangePercentage)]})]})]})]})})})]}),e.jsxs(We,{cols:{default:1,lg:3},gap:6,children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Top Products (30d)"})}),e.jsx("div",{className:"card-content",children:$?e.jsx(Y,{}):((ye=P==null?void 0:P.topProducts)==null?void 0:ye.length)>0?e.jsx("div",{className:"space-y-3",children:P.topProducts.map((a,g)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",g+1]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.product.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Category: ",a.product.category||"N/A"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:F(a.metrics.totalRevenue)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.metrics.totalQuantity," units"]})]})]},a.product._id))}):e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx(Z,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm",children:"No product data available"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Top Customers by Sales (30d)"})}),e.jsx("div",{className:"card-content",children:E?e.jsx(Y,{}):((ve=D==null?void 0:D.topCustomers)==null?void 0:ve.length)>0?e.jsx("div",{className:"space-y-3",children:D.topCustomers.map((a,g)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",g+1]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.customer.displayName}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:a.customer.businessType})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:F(a.metrics.totalRevenue)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.metrics.totalOrders," orders"]})]})]},a.customer._id))}):e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx(L,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm",children:"No customer data available"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Top Customers by Profit (30d)"})}),e.jsx("div",{className:"card-content",children:t?e.jsx(Y,{}):((Ne=S==null?void 0:S.topCustomers)==null?void 0:Ne.length)>0?e.jsx("div",{className:"space-y-3",children:S.topCustomers.map((a,g)=>{var _;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["#",g+1]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.customer.displayName}),e.jsx("p",{className:"text-xs text-gray-500 capitalize",children:a.customer.businessType})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:F(a.metrics.totalProfit)}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Margin ",((_=a.metrics.margin)==null?void 0:_.toFixed(1))||0,"%"]})]})]},a.customer._id)})}):e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx(L,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm",children:"No customer profit data available"})]})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsx("div",{className:"flex-1 max-w-lg",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search reports...",value:i,onChange:a=>I(a.target.value),className:"input pl-10"})]})}),e.jsxs("button",{onClick:()=>k(!R),className:`btn ${R?"btn-primary":"btn-secondary"}`,children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Filters"]})]}),R&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-content",children:e.jsx(us,{filters:m,onFilterChange:v,onClose:()=>k(!1)})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reports"})}),e.jsx("div",{className:"card-content p-0",children:j?e.jsx(Ke,{}):((be=p==null?void 0:p.reports)==null?void 0:be.length)>0?e.jsx("div",{className:"divide-y divide-gray-200",children:p.reports.map(a=>e.jsx("div",{className:"p-6 hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:Ee(a.reportType)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:a.reportName}),a.isFavorite&&e.jsx(se,{className:"h-4 w-4 text-yellow-500 fill-current"})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:_e(a.reportType)}),e.jsxs("span",{className:"text-xs text-gray-500",children:[a.periodType," â€¢ ",Fe(a.generatedAt)]}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${Ae(a.status)}`,children:[Oe(a.status),e.jsx("span",{className:"ml-1 capitalize",children:a.status})]})]}),a.summary&&e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Revenue: ",F(a.summary.totalRevenue)]}),e.jsxs("span",{children:["Orders: ",a.summary.totalOrders]}),e.jsxs("span",{children:["AOV: ",F(a.summary.averageOrderValue)]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>B(a),className:"text-gray-400 hover:text-gray-600",title:"View Report",children:e.jsx(ss,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Pe(a.reportId,!a.isFavorite),className:`${a.isFavorite?"text-yellow-500 hover:text-yellow-600":"text-gray-400 hover:text-gray-600"}`,title:a.isFavorite?"Remove from favorites":"Add to favorites",children:e.jsx(se,{className:`h-4 w-4 ${a.isFavorite?"fill-current":""}`})}),e.jsx("div",{className:"relative",children:e.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:e.jsx(as,{className:"h-4 w-4"})})})]})]})},a.reportId))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No reports found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by creating your first sales performance report."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:()=>u(!0),className:"btn btn-primary btn-md",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Create Report"]})})]})})]}),(p==null?void 0:p.pagination)&&p.pagination.pages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(m.page-1)*m.limit+1," to"," ",Math.min(m.page*m.limit,p.pagination.total)," of"," ",p.pagination.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>c(a=>({...a,page:a.page-1})),disabled:!p.pagination.hasPrev,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>c(a=>({...a,page:a.page+1})),disabled:!p.pagination.hasNext,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),e.jsx(xs,{isOpen:O,onClose:()=>u(!1),onSuccess:()=>{u(!1),U.success("Report generation started")}}),e.jsx(hs,{isOpen:N,onClose:()=>d(!1),report:h,onDelete:a=>{ee(a),d(!1)},onExport:Se})]})};export{Ps as default};
