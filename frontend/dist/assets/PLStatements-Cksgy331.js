import{D as se,F as le,r as m,y as oe,p as e,a3 as w,aJ as ee,S as ie,V as de,q as i,T,aQ as ce}from"./index-CPGRFPoA.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=se("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=se("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),me=le.injectEndpoints({endpoints:a=>({generateStatement:a.mutation({query:s=>({url:"pl-statements/generate",method:"post",data:s}),invalidatesTags:[{type:"Reports",id:"PL_STATEMENTS"}]}),getStatements:a.query({query:s=>({url:"pl-statements",method:"get",params:s}),providesTags:s=>{var r,n;return(r=s==null?void 0:s.data)!=null&&r.statements||s!=null&&s.statements?[...(((n=s.data)==null?void 0:n.statements)||s.statements).map(({_id:d,id:b})=>({type:"Reports",id:d||b})),{type:"Reports",id:"PL_STATEMENTS"}]:[{type:"Reports",id:"PL_STATEMENTS"}]}}),getStatement:a.query({query:s=>({url:`pl-statements/${s}`,method:"get"}),providesTags:(s,r,n)=>[{type:"Reports",id:n}]}),updateStatement:a.mutation({query:({id:s,...r})=>({url:`pl-statements/${s}`,method:"put",data:r}),invalidatesTags:(s,r,{id:n})=>[{type:"Reports",id:n},{type:"Reports",id:"PL_STATEMENTS"}]}),updateStatementStatus:a.mutation({query:({id:s,...r})=>({url:`pl-statements/${s}/status`,method:"put",data:r}),invalidatesTags:(s,r,{id:n})=>[{type:"Reports",id:n},{type:"Reports",id:"PL_STATEMENTS"}]}),deleteStatement:a.mutation({query:s=>({url:`pl-statements/${s}`,method:"delete"}),invalidatesTags:(s,r,n)=>[{type:"Reports",id:n},{type:"Reports",id:"PL_STATEMENTS"}]}),getSummary:a.query({query:s=>({url:"pl-statements/summary",method:"get",params:s}),providesTags:[{type:"Reports",id:"PL_STATEMENTS_SUMMARY"}]}),getTrends:a.query({query:s=>({url:"pl-statements/trends",method:"get",params:s}),providesTags:[{type:"Reports",id:"PL_STATEMENTS_TRENDS"}]}),getComparison:a.query({query:({id:s,type:r="previous"})=>({url:`pl-statements/${s}/comparison`,method:"get",params:{type:r}}),providesTags:(s,r,{id:n})=>[{type:"Reports",id:`COMPARISON_${n}`}]}),exportStatement:a.mutation({query:({id:s,...r})=>({url:`pl-statements/${s}/export`,method:"post",data:r,responseType:"blob"})}),getLatestStatement:a.query({query:s=>({url:"pl-statements/latest",method:"get",params:s}),providesTags:[{type:"Reports",id:"PL_STATEMENTS_LATEST"}]})}),overrideExisting:!1}),{useGetSummaryQuery:ge}=me,j=(a=new Date)=>{const s=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),n=String(a.getDate()).padStart(2,"0");return`${s}-${r}-${n}`},f=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",pe=()=>{var E,M,_,A,k,$,q,I,C,F,O,G,U,Y,V,z,B,Q,J,H,K,W,X,Z;const a=new Date,s=new Date(a.getFullYear(),a.getMonth(),1),[r,n]=m.useState(j(s)),[d,b]=m.useState(j(a)),[N,ae]=m.useState(j(s)),[u,re]=m.useState(j(a)),[c,D]=m.useState(!1),{data:g,isLoading:h,error:o,refetch:L}=ge({startDate:N,endDate:u},{skip:!c,onError:x=>oe(x,"Profit & Loss Statement")}),ne=()=>{if(!r||!d){alert("Please select both From Date and To Date");return}if(new Date(r)>new Date(d)){alert("From Date cannot be after To Date");return}ae(r),re(d),D(!0),L()},t=(g==null?void 0:g.data)||g,v=((M=(E=t==null?void 0:t.revenue)==null?void 0:E.totalRevenue)==null?void 0:M.amount)||((k=(A=(_=t==null?void 0:t.statement)==null?void 0:_.revenue)==null?void 0:A.totalRevenue)==null?void 0:k.amount)||(t==null?void 0:t.totalRevenue)||0,y=(($=t==null?void 0:t.grossProfit)==null?void 0:$.amount)||((I=(q=t==null?void 0:t.statement)==null?void 0:q.grossProfit)==null?void 0:I.amount)||(t==null?void 0:t.grossProfit)||0,S=((C=t==null?void 0:t.operatingIncome)==null?void 0:C.amount)||((O=(F=t==null?void 0:t.statement)==null?void 0:F.operatingIncome)==null?void 0:O.amount)||(t==null?void 0:t.operatingIncome)||0,l=((G=t==null?void 0:t.netIncome)==null?void 0:G.amount)||((Y=(U=t==null?void 0:t.statement)==null?void 0:U.netIncome)==null?void 0:Y.amount)||(t==null?void 0:t.netIncome)||0,P=((V=t==null?void 0:t.grossProfit)==null?void 0:V.margin)||((B=(z=t==null?void 0:t.statement)==null?void 0:z.grossProfit)==null?void 0:B.margin)||(t==null?void 0:t.grossMargin),R=((Q=t==null?void 0:t.operatingIncome)==null?void 0:Q.margin)||((H=(J=t==null?void 0:t.statement)==null?void 0:J.operatingIncome)==null?void 0:H.margin)||(t==null?void 0:t.operatingMargin),p=((K=t==null?void 0:t.netIncome)==null?void 0:K.margin)||((X=(W=t==null?void 0:t.statement)==null?void 0:W.netIncome)==null?void 0:X.margin)||(t==null?void 0:t.netMargin);return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(w,{className:"h-7 w-7 mr-3 text-primary-600"}),"Profit & Loss Statement"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View your business financial performance"})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(ee,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:r,onChange:x=>n(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(ee,{className:"h-5 w-5 text-gray-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:d,onChange:x=>b(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:ne,disabled:h,className:"btn btn-primary flex items-center space-x-2 px-6 py-2.5 h-fit disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{children:h?"Loading...":"Search"})]})})]}),c&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing data from ",e.jsx("strong",{children:f(N)})," to ",e.jsx("strong",{children:f(u)})]})})]})]}),h&&c&&e.jsxs("div",{className:"flex justify-center items-center py-12",children:[e.jsx(de,{}),e.jsx("p",{className:"ml-3 text-gray-600",children:"Loading Profit & Loss data..."})]}),o&&c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading Profit & Loss data"}),e.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[e.jsx("p",{children:((Z=o==null?void 0:o.data)==null?void 0:Z.message)||(o==null?void 0:o.message)||"An unexpected error occurred. Please try again."}),!1]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>{D(!0),L()},className:"text-sm font-medium text-red-800 hover:text-red-900 underline",children:"Try again"})})]})]})}),!h&&!o&&c&&t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg border-2 border-green-300 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-green-800 uppercase tracking-wide",children:"Total Revenue"}),e.jsx(te,{className:"h-6 w-6 text-green-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:i(v)}),e.jsx("p",{className:"text-xs text-green-700 mt-2",children:"All income from sales"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg border-2 border-blue-300 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-800 uppercase tracking-wide",children:"Gross Profit"}),e.jsx(T,{className:"h-6 w-6 text-blue-600"})]}),e.jsx("p",{className:`text-3xl font-bold ${y>=0?"text-blue-900":"text-red-600"}`,children:i(y)}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"Revenue - Cost of Goods Sold"}),P!==void 0&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Margin: ",P.toFixed(1),"%"]})]}),e.jsxs("div",{className:`bg-gradient-to-br rounded-lg border-2 p-6 shadow-sm ${l>=0?"from-teal-50 to-teal-100 border-teal-300":"from-red-50 to-red-100 border-red-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`text-sm font-semibold uppercase tracking-wide ${l>=0?"text-teal-800":"text-red-800"}`,children:"Net Profit / Loss"}),l>=0?e.jsx(T,{className:"h-6 w-6 text-teal-600"}):e.jsx(ce,{className:"h-6 w-6 text-red-600"})]}),e.jsx("p",{className:`text-3xl font-bold ${l>=0?"text-teal-900":"text-red-900"}`,children:i(l)}),e.jsx("p",{className:`text-xs mt-2 ${l>=0?"text-teal-700":"text-red-700"}`,children:"Gross Profit - Operating Expenses"}),p!==void 0&&e.jsxs("p",{className:`text-xs mt-1 ${l>=0?"text-teal-600":"text-red-600"}`,children:["Margin: ",p.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Breakdown"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Period: ",f(N)," to ",f(u)]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(te,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue"})]}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Revenue"}),e.jsx("span",{className:"text-xl font-bold text-green-700",children:i(v)})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(xe,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Expenses"})]}),e.jsx("div",{className:"bg-red-50 rounded-lg p-4 border border-red-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Expenses"}),e.jsx("span",{className:"text-xl font-bold text-red-700",children:i(v-y)})]})})]}),S!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(T,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Operating Income"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Operating Income"}),e.jsx("span",{className:`text-xl font-bold ${S>=0?"text-blue-700":"text-red-700"}`,children:i(S)})]}),R!==void 0&&e.jsxs("p",{className:"text-sm text-blue-600 mt-2",children:["Operating Margin: ",R.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-6 border-2 border-gray-300",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Net Profit / Loss"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Your final profit or loss for this period"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-3xl font-bold ${l>=0?"text-teal-700":"text-red-700"}`,children:i(l)}),p!==void 0&&e.jsxs("p",{className:`text-sm mt-1 ${l>=0?"text-teal-600":"text-red-600"}`,children:["Net Margin: ",p.toFixed(1),"%"]})]})]})})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(w,{className:"h-5 w-5 text-blue-600 mr-3 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Understanding Your Profit & Loss Statement"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Total Revenue:"})," All money received from sales"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Gross Profit:"})," Revenue minus the cost of goods you sold"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Operating Income:"})," Gross profit minus operating expenses"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Net Profit/Loss:"})," Your final profit or loss after all expenses"]})]})]})]})})]}),!c&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(w,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Date Range and Click Search"}),e.jsx("p",{className:"text-gray-600",children:"Choose your date range above and click the Search button to view your Profit & Loss statement."})]})]})};export{pe as PLStatements,pe as default};
