import{r as x}from"./index-jd7Ax_Ed.js";const A=(r,s)=>{const n=(r||"").toLowerCase(),o=(s||"").toLowerCase();if(n===o)return 0;if(n.length===0)return o.length;if(o.length===0)return n.length;const l=[];for(let e=0;e<=o.length;e++)l[e]=[e];for(let e=0;e<=n.length;e++)l[0][e]=e;for(let e=1;e<=o.length;e++)for(let a=1;a<=n.length;a++)o.charAt(e-1)===n.charAt(a-1)?l[e][a]=l[e-1][a-1]:l[e][a]=Math.min(l[e-1][a-1]+1,l[e][a-1]+1,l[e-1][a]+1);return l[o.length][n.length]},M=(r,s,n={})=>{const{threshold:o=.6,caseSensitive:l=!1,wholeWords:e=!1,maxDistance:a=3}=n;if(!r||!s)return{matched:!1,score:0,type:"none"};const f=l?r:r.toLowerCase(),u=l?s:s.toLowerCase();if(f===u)return{matched:!0,score:1,type:"exact"};if(f.includes(u))return{matched:!0,score:.8+u.length/f.length*.2,type:"contains"};if(e){const t=f.split(/\s+/);for(const c of t)if(c===u||c.startsWith(u))return{matched:!0,score:.9,type:"word"}}const g=A(r,s),h=Math.max(r.length,s.length),d=h>0?1-g/h:0;if(g<=a&&d>=o)return{matched:!0,score:d,type:"fuzzy"};const p=u.split(/\s+/).filter(t=>t.length>2);if(p.length>0){let t=0,c=0;for(const y of p)if(f.includes(y))t++,c+=.7;else{const w=f.split(/\s+/);for(const i of w)if(A(i,y)<=2&&i.length>=y.length-2){t++,c+=.5;break}}if(t>0)return{matched:!0,score:c/p.length,type:"partial"}}return{matched:!1,score:0,type:"none"}},L=(r,s,n,o={})=>{if(!r||!Array.isArray(r)||r.length===0)return[];if(!s||s.trim().length===0)return r;const{threshold:l=.4,limit:e=null,minScore:a=.3,caseSensitive:f=!1}=o,u=s.trim(),g=[];let h=[];typeof n=="string"?h=[t=>S(t,n)]:Array.isArray(n)?h=n.map(t=>typeof t=="function"?t:c=>S(c,t)):typeof n=="function"?h=[n]:h=[t=>t.name||t.title||t.companyName||t.businessName||"",t=>t.description||"",t=>t.email||"",t=>t.phone||"",t=>t.code||t.sku||t.poNumber||t.orderNumber||""];for(const t of r){let c=0,y=null;for(const w of h)try{const i=w(t);if(i==null)continue;const z=Array.isArray(i)?i.join(" "):String(i),m=M(z,u,{threshold:l,caseSensitive:f});m.matched&&m.score>c&&(c=m.score,y=m)}catch(i){console.warn("Error accessing field in fuzzy search:",i)}y&&c>=a&&g.push({item:t,score:c,matchType:y.type})}const d={exact:4,contains:3,word:2,fuzzy:1,partial:0};g.sort((t,c)=>Math.abs(t.score-c.score)>.01?c.score-t.score:d[c.matchType]-d[t.matchType]);const p=g.map(t=>t.item);return e?p.slice(0,e):p},S=(r,s)=>{if(!r||!s)return"";const n=s.split(".");let o=r;for(const l of n){if(o==null)return"";o=o[l]}return o!=null?String(o):""},W=(r,s,n,o={})=>x.useMemo(()=>!r||!Array.isArray(r)?[]:!s||s.trim().length===0?r:L(r,s,n,o),[r,s,n,o]);export{W as u};
