import{r as u,bb as Ze,bc as De,ai as es,d as ss,R as Be,bd as ts,be as as,bf as ns,bg as rs,bh as cs,bi as is,bj as ls,bk as os,p as e,S as ie,aJ as ms,s as ds,w as X,x as ke,y as J,A as le,E as us,B as Z,z as D,F as C}from"./index-CPGRFPoA.js";import{u as xs}from"./suppliersApi-vtSX7WY2.js";import{P as ps}from"./PrintModal-BVN5BxWf.js";import{D as hs}from"./download-sJC695Ir.js";import{P as gs}from"./plus-0pBJo49N.js";import{S as bs}from"./save-Cm4Ve9_y.js";import{F as fs}from"./filter-GYW4ITtG.js";import{P as js}from"./printer-Cmw_Pmcr.js";import{P as ys}from"./pen-square-sDWyQdA0.js";import{T as vs}from"./trash-2-CJJmzTJU.js";import"./useCompanyInfo-KiNc03tu.js";import"./settingsApi-C2p-obM0.js";const oe=(L=new Date)=>{const N=L.getFullYear(),ee=String(L.getMonth()+1).padStart(2,"0"),f=String(L.getDate()).padStart(2,"0");return`${N}-${ee}-${f}`},Us=()=>{var ye,ve,Ne,we,Ce;const L=oe(),[N,ee]=u.useState({fromDate:L,toDate:L,voucherCode:"",amount:"",particular:""}),[f,O]=u.useState({page:1,limit:50}),[me,Se]=u.useState({key:"date",direction:"desc"}),[Ae,W]=u.useState(!1),[Me,se]=u.useState(!1),[_e,de]=u.useState(!1),[g,F]=u.useState(null),[I,ue]=u.useState(null),[b,y]=u.useState(null),[h,B]=u.useState(null),[R,k]=u.useState(""),[T,A]=u.useState(""),[Y,Q]=u.useState(-1),[H,U]=u.useState(-1),[j,z]=u.useState("customer"),[l,x]=u.useState({date:L,amount:"",particular:"",customer:"",supplier:"",notes:""}),{data:d,isLoading:Pe,error:xe,refetch:q}=Ze({...N,...f,sortConfig:me},{refetchOnMountOrArgChange:!0}),[Ee]=De(),w=es(),{data:v,isLoading:pe,error:Ns,refetch:te}=ss({search:"",limit:100},{refetchOnMountOrArgChange:!0}),M=Be.useMemo(()=>{var s;return((s=v==null?void 0:v.data)==null?void 0:s.customers)||(v==null?void 0:v.customers)||v||[]},[v]),{data:_,isLoading:ws,error:Cs,refetch:ae}=xs({search:"",limit:100},{refetchOnMountOrArgChange:!0}),G=Be.useMemo(()=>{var s;return((s=_==null?void 0:_.data)==null?void 0:s.suppliers)||(_==null?void 0:_.suppliers)||_||[]},[_]);u.useEffect(()=>{if(b!=null&&b._id&&M&&M.length>0){const s=M.find(n=>n._id===b._id);if(s){const n=b.pendingBalance||0,t=b.advanceBalance||0,c=s.pendingBalance||0,a=s.advanceBalance||0;(n!==c||t!==a)&&y(s)}}},[v,b==null?void 0:b._id]);const[Le,{isLoading:he}]=ts(),[Fe,{isLoading:ge}]=as(),[Re,{isLoading:Bs}]=ns(),[Te]=rs(),[Qe]=cs(),[Ue]=is(),[$e]=ls(),[Oe]=os(),V=()=>{x({date:oe(),amount:"",particular:"",customer:"",supplier:"",notes:""}),y(null),B(null),k(""),A(""),Q(-1),U(-1),z("customer")},ne=u.useRef(null),be=s=>{const n=M==null?void 0:M.find(t=>t._id===s);n&&y(n),x(t=>({...t,customer:s})),ne.current&&clearTimeout(ne.current),ne.current=setTimeout(async()=>{var t;try{const{data:c}=await Ee(s),a=((t=c==null?void 0:c.data)==null?void 0:t.customer)||(c==null?void 0:c.customer)||(c==null?void 0:c.data)||c;a&&(y(i=>(i==null?void 0:i._id)===s?a:i),w(C.util.setQueryData(["customers",{search:"",limit:100}],i=>{var r;if(!i)return i;const m=(((r=i==null?void 0:i.data)==null?void 0:r.customers)||(i==null?void 0:i.customers)||(i==null?void 0:i.data)||[]).map(p=>p._id===s?a:p);return{...i,data:{...i.data,customers:m},customers:m}})))}catch{}},200)},Ve=s=>{k(s),Q(-1),s===""&&(y(null),x(n=>({...n,customer:""})))},ze=s=>{const n=(M||[]).filter(t=>(t.businessName||t.name||"").toLowerCase().includes(R.toLowerCase())||(t.phone||"").includes(R));if(!(!R||n.length===0))switch(s.key){case"ArrowDown":s.preventDefault(),Q(t=>t<n.length-1?t+1:0);break;case"ArrowUp":s.preventDefault(),Q(t=>t>0?t-1:n.length-1);break;case"Enter":if(s.preventDefault(),Y>=0&&Y<n.length){const t=n[Y];be(t._id),k(t.businessName||t.name||""),Q(-1)}break;case"Escape":s.preventDefault(),k(""),Q(-1);break}},fe=s=>{const n=G==null?void 0:G.find(t=>t._id===s);B(n),x(t=>({...t,supplier:s,customer:""})),y(null),k("")},qe=s=>{A(s),U(-1),s===""&&(B(null),x(n=>({...n,supplier:""})))},Ge=s=>{const n=(G||[]).filter(t=>(t.companyName||t.name||"").toLowerCase().includes(T.toLowerCase())||(t.phone||"").includes(T));if(!(!T||n.length===0))switch(s.key){case"ArrowDown":s.preventDefault(),U(t=>t<n.length-1?t+1:0);break;case"ArrowUp":s.preventDefault(),U(t=>t>0?t-1:n.length-1);break;case"Enter":if(s.preventDefault(),H>=0&&H<n.length){const t=n[H];fe(t._id),A(t.companyName||t.name||""),U(-1)}break;case"Escape":s.preventDefault(),A(""),U(-1);break}},K=(s,n)=>{ee(t=>({...t,[s]:n})),O(t=>({...t,page:1}))},re=s=>{Se(n=>({key:s,direction:n.key===s&&n.direction==="asc"?"desc":"asc"}))},Ke=()=>{const s={date:l.date||oe(),amount:parseFloat(l.amount)||0,particular:l.particular||void 0,notes:l.notes||void 0,paymentMethod:"cash"};j==="customer"&&l.customer?s.customer=l.customer:j==="supplier"&&l.supplier&&(s.supplier=l.supplier),Le(s).unwrap().then(()=>{if(V(),Z("Cash receipt created successfully"),q(),j==="customer"&&l.customer&&b){const n=parseFloat(s.amount)||0;y(t=>{if(!t)return t;const c=(t.advanceBalance||0)+n;return{...t,advanceBalance:c}}),w(C.util.setQueryData(["customers",{search:"",limit:100}],t=>{var i;if(!t)return t;const a=(((i=t==null?void 0:t.data)==null?void 0:i.customers)||(t==null?void 0:t.customers)||(t==null?void 0:t.data)||[]).map(o=>{if(o._id===l.customer){const m=(o.advanceBalance||0)+n;return{...o,advanceBalance:m}}return o});return{...t,data:{...t.data,customers:a},customers:a}})),w(C.util.setQueryData(["getCustomer",l.customer],t=>{var i;if(!t)return t;const c=((i=t==null?void 0:t.data)==null?void 0:i.customer)||(t==null?void 0:t.customer)||(t==null?void 0:t.data)||t,a=(c.advanceBalance||0)+n;return{...t,data:{...t.data,customer:{...c,advanceBalance:a}},customer:{...c,advanceBalance:a}}})),te()}else if(j==="supplier"&&l.supplier&&h){const n=parseFloat(s.amount)||0;B(t=>{if(!t)return t;const c=(t.advanceBalance||0)+n;return{...t,advanceBalance:c}}),w(C.util.setQueryData(["suppliers",{search:"",limit:100}],t=>{var i;if(!t)return t;const a=(((i=t==null?void 0:t.data)==null?void 0:i.suppliers)||(t==null?void 0:t.suppliers)||(t==null?void 0:t.data)||[]).map(o=>{if(o._id===l.supplier){const m=(o.advanceBalance||0)+n;return{...o,advanceBalance:m}}return o});return{...t,data:{...t.data,suppliers:a},suppliers:a}})),ae()}}).catch(n=>{D(J(n))})},Je=()=>{const s={date:l.date,amount:parseFloat(l.amount)||0,particular:l.particular||void 0,notes:l.notes||void 0};j==="customer"&&l.customer?s.customer=l.customer:j==="supplier"&&l.supplier&&(s.supplier=l.supplier);const n=(g==null?void 0:g.amount)||0,c=(parseFloat(s.amount)||0)-n;Fe({id:g._id,...s}).unwrap().then(()=>{W(!1),F(null),V(),Z("Cash receipt updated successfully"),q(),j==="customer"&&l.customer&&b&&c!==0?(y(a=>{if(!a)return a;const i=(a.advanceBalance||0)+c;return{...a,advanceBalance:i}}),w(C.util.setQueryData(["customers",{search:"",limit:100}],a=>{var m;if(!a)return a;const o=(((m=a==null?void 0:a.data)==null?void 0:m.customers)||(a==null?void 0:a.customers)||(a==null?void 0:a.data)||[]).map(r=>{if(r._id===l.customer){const p=(r.advanceBalance||0)+c;return{...r,advanceBalance:p}}return r});return{...a,data:{...a.data,customers:o},customers:o}})),w(C.util.setQueryData(["getCustomer",l.customer],a=>{var m;if(!a)return a;const i=((m=a==null?void 0:a.data)==null?void 0:m.customer)||(a==null?void 0:a.customer)||(a==null?void 0:a.data)||a,o=(i.advanceBalance||0)+c;return{...a,data:{...a.data,customer:{...i,advanceBalance:o}},customer:{...i,advanceBalance:o}}})),te()):j==="supplier"&&l.supplier&&h&&c!==0&&(B(a=>{if(!a)return a;const i=(a.advanceBalance||0)+c;return{...a,advanceBalance:i}}),w(C.util.setQueryData(["suppliers",{search:"",limit:100}],a=>{var m;if(!a)return a;const o=(((m=a==null?void 0:a.data)==null?void 0:m.suppliers)||(a==null?void 0:a.suppliers)||(a==null?void 0:a.data)||[]).map(r=>{if(r._id===l.supplier){const p=(r.advanceBalance||0)+c;return{...r,advanceBalance:p}}return r});return{...a,data:{...a.data,suppliers:o},suppliers:o}})),ae())}).catch(a=>{D(J(a))})},We=s=>{var o,m;const n=typeof s=="string"?s:s._id,t=typeof s=="object"?s:null,c=t&&parseFloat(t.amount)||0,a=((o=t==null?void 0:t.customer)==null?void 0:o._id)||(t==null?void 0:t.customer)||null,i=((m=t==null?void 0:t.supplier)==null?void 0:m._id)||(t==null?void 0:t.supplier)||null;window.confirm("Are you sure you want to delete this cash receipt?")&&Re(n).unwrap().then(()=>{Z("Cash receipt deleted successfully"),q(),a&&c>0?(y(r=>{if(r&&r._id===a){const p=Math.max(0,(r.advanceBalance||0)-c);return{...r,advanceBalance:p}}return r}),w(C.util.setQueryData(["customers",{search:"",limit:100}],r=>{var E;if(!r)return r;const P=(((E=r==null?void 0:r.data)==null?void 0:E.customers)||(r==null?void 0:r.customers)||(r==null?void 0:r.data)||[]).map(S=>{if(S._id===a){const ce=Math.max(0,(S.advanceBalance||0)-c);return{...S,advanceBalance:ce}}return S});return{...r,data:{...r.data,customers:P},customers:P}})),w(C.util.setQueryData(["getCustomer",a],r=>{var E;if(!r)return r;const p=((E=r==null?void 0:r.data)==null?void 0:E.customer)||(r==null?void 0:r.customer)||(r==null?void 0:r.data)||r,P=Math.max(0,(p.advanceBalance||0)-c);return{...r,data:{...r.data,customer:{...p,advanceBalance:P}},customer:{...p,advanceBalance:P}}})),te()):i&&c>0&&(B(r=>{if(r&&r._id===i){const p=Math.max(0,(r.advanceBalance||0)-c);return{...r,advanceBalance:p}}return r}),w(C.util.setQueryData(["suppliers",{search:"",limit:100}],r=>{var E;if(!r)return r;const P=(((E=r==null?void 0:r.data)==null?void 0:E.suppliers)||(r==null?void 0:r.suppliers)||(r==null?void 0:r.data)||[]).map(S=>{if(S._id===i){const ce=Math.max(0,(S.advanceBalance||0)-c);return{...S,advanceBalance:ce}}return S});return{...r,data:{...r.data,suppliers:P},suppliers:P}})),ae())}).catch(r=>{D(J(r))})},Ie=s=>{var n,t,c,a;F(s),x({date:s.date?s.date.split("T")[0]:"",amount:s.amount||"",particular:s.particular||"",customer:((n=s.customer)==null?void 0:n._id)||"",supplier:((t=s.supplier)==null?void 0:t._id)||"",notes:s.notes||""}),(c=s.supplier)!=null&&c._id?(z("supplier"),B(s.supplier),A(s.supplier.companyName||s.supplier.name||""),y(null),k("")):(a=s.customer)!=null&&a._id&&(z("customer"),y(s.customer),k(s.customer.businessName||s.customer.name||""),B(null),A("")),W(!0)},Ye=s=>{F(s),se(!0)},He=async(s="csv")=>{try{const n={...N,...f,sortConfig:me};let t;s==="excel"?t=await Te(n).unwrap():s==="pdf"?t=await Ue(n).unwrap():s==="json"?t=await $e(n).unwrap():t=await Qe(n).unwrap();const c=(t==null?void 0:t.filename)||(s==="excel"?"cash_receipts.xlsx":s==="pdf"?"cash_receipts.pdf":s==="json"?"cash_receipts.json":"cash_receipts.csv"),a=await Oe(c).unwrap(),i=a instanceof Blob?a:new Blob([a],{type:s==="excel"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":s==="pdf"?"application/pdf":s==="json"?"application/json":"text/csv"}),o=URL.createObjectURL(i),m=document.createElement("a");m.href=o,m.download=c,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(o),Z(`Exported cash receipts as ${s.toUpperCase()}`)}catch(n){D(J(n,"Cash Receipts Export"))}},Xe=s=>{const n={invoiceNumber:s.voucherCode,orderNumber:s.voucherCode,createdAt:s.date,invoiceDate:s.date,customer:s.customer||null,customerInfo:s.customer||null,supplier:s.supplier||null,pricing:{subtotal:s.amount||0,total:s.amount||0,discountAmount:0,taxAmount:0},total:s.amount||0,subtotal:s.amount||0,items:[],payment:{method:"Cash",status:"Paid",amountPaid:s.amount||0},notes:s.notes||s.particular||""};ue(n),de(!0)},je=((ye=d==null?void 0:d.data)==null?void 0:ye.cashReceipts)||(d==null?void 0:d.cashReceipts)||((ve=d==null?void 0:d.data)==null?void 0:ve.receipts)||(d==null?void 0:d.receipts)||[],$=((Ne=d==null?void 0:d.data)==null?void 0:Ne.pagination)||(d==null?void 0:d.pagination)||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cash Receipts"}),e.jsx("p",{className:"text-gray-600",children:"Manage and view all cash receipt transactions"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:He,className:"btn btn-secondary flex items-center space-x-2",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]}),e.jsxs("button",{onClick:V,className:"btn btn-primary btn-md",children:[e.jsx(gs,{className:"h-4 w-4 mr-2"}),"New Receipt"]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Receipt Details"})}),e.jsxs("div",{className:"card-content",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Receipt Type"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"customer",checked:j==="customer",onChange:s=>{z(s.target.value),B(null),A(""),x(n=>({...n,supplier:""}))},className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Customer"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"supplier",checked:j==="supplier",onChange:s=>{z(s.target.value),y(null),k(""),x(n=>({...n,customer:""}))},className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Supplier"})]})]})]}),j==="customer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:R,onChange:s=>Ve(s.target.value),onKeyDown:ze,className:"input w-full pr-10",placeholder:"Search or select customer..."}),e.jsx(ie,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),R&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:(M||[]).filter(s=>(s.businessName||s.name||"").toLowerCase().includes(R.toLowerCase())||(s.phone||"").includes(R)).map((s,n)=>{const t=s.pendingBalance||0,c=s.advanceBalance||0,a=t-c,i=a<0,o=t>0||c>0;return e.jsxs("div",{onClick:()=>{be(s._id),k(s.businessName||s.name||""),Q(-1)},className:`px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0 ${Y===n?"bg-blue-50":""}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.businessName||s.name||"Unknown"}),o&&e.jsxs("div",{className:`text-sm ${i?"text-red-600":"text-green-600"}`,children:[i?"Payables:":"Receivables:"," $",Math.abs(a).toFixed(2)]})]},s._id)})})]}),b&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balance"}),e.jsx("div",{className:"space-y-1",children:(()=>{const s=b.pendingBalance||0,n=b.advanceBalance||0,t=s-n,c=t<0,a=t>0;return s>0||n>0?e.jsxs("div",{className:`flex items-center justify-between px-3 py-2 rounded ${c?"bg-red-50 border border-red-200":a?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"}`,children:[e.jsx("span",{className:`text-sm font-medium ${c?"text-red-700":a?"text-green-700":"text-gray-700"}`,children:c?"Payables:":a?"Receivables:":"Balance:"}),e.jsx("span",{className:`text-sm font-bold ${c?"text-red-700":a?"text-green-700":"text-gray-700"}`,children:Math.abs(t).toFixed(2)})]}):e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded text-sm text-gray-600 text-center",children:"No balance"})})()})]}),j==="supplier"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:T,onChange:s=>qe(s.target.value),onKeyDown:Ge,className:"input w-full pr-10",placeholder:"Search or select supplier..."}),e.jsx(ie,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),T&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md bg-white shadow-lg",children:(G||[]).filter(s=>(s.companyName||s.name||"").toLowerCase().includes(T.toLowerCase())||(s.phone||"").includes(T)).map((s,n)=>e.jsxs("div",{onClick:()=>{fe(s._id),A(s.companyName||s.name||""),U(-1)},className:`px-3 py-2 hover:bg-gray-100 cursor-pointer border-b border-gray-100 last:border-b-0 ${H===n?"bg-blue-50":""}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.companyName||s.name||"Unknown"}),s.phone&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Phone: ",s.phone]})]},s._id))})]}),j==="supplier"&&h&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balance"}),e.jsxs("div",{className:"space-y-1",children:[h.pendingBalance>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-red-50 border border-red-200 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Payables:"}),e.jsx("span",{className:"text-sm font-bold text-red-700",children:h.pendingBalance.toFixed(2)})]}),h.advanceBalance>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-green-50 border border-green-200 rounded",children:[e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Advance:"}),e.jsx("span",{className:"text-sm font-bold text-green-700",children:h.advanceBalance.toFixed(2)})]}),h.pendingBalance===0&&h.advanceBalance===0&&e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded text-sm text-gray-600 text-center",children:"No balance"}),h.pendingBalance>0&&h.advanceBalance>0&&e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-blue-50 border-2 border-blue-300 rounded",children:[e.jsx("span",{className:"text-sm font-bold text-blue-700",children:"Net Balance:"}),e.jsx("span",{className:`text-sm font-bold ${h.pendingBalance-h.advanceBalance>0?"text-red-700":"text-green-700"}`,children:(h.pendingBalance-h.advanceBalance).toFixed(2)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:l.amount,onChange:s=>{const n=s.target.value===""?"":parseFloat(s.target.value)||"";x(t=>({...t,amount:n}))},className:"input w-full",placeholder:"0.00",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Receipt Date"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:l.date,onChange:s=>x(n=>({...n,date:s.target.value})),className:"input w-full pr-10"}),e.jsx(ms,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("input",{type:"text",value:l.particular,onChange:s=>x(n=>({...n,particular:s.target.value})),className:"input w-full",placeholder:"Enter receipt description..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:l.notes,onChange:s=>x(n=>({...n,notes:s.target.value})),className:"input w-full h-20 resize-none",placeholder:"Additional notes..."})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("button",{onClick:V,className:"btn btn-secondary flex items-center space-x-2",children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx("span",{children:"Reset"})]}),e.jsxs("button",{onClick:Ke,disabled:he,className:"btn btn-primary flex items-center space-x-2",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx("span",{children:he?"Saving...":"Save Receipt"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fs,{className:"h-5 w-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Filters"})]})}),e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From Date"}),e.jsx("input",{type:"date",value:N.fromDate,onChange:s=>K("fromDate",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To Date"}),e.jsx("input",{type:"date",value:N.toDate,onChange:s=>K("toDate",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voucher Code"}),e.jsx("input",{type:"text",placeholder:"Contains...",value:N.voucherCode,onChange:s=>K("voucherCode",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),e.jsx("input",{type:"number",placeholder:"Equals...",value:N.amount,onChange:s=>K("amount",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Particular"}),e.jsx("input",{type:"text",placeholder:"Contains...",value:N.particular,onChange:s=>K("particular",s.target.value),className:"input"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>q(),className:"btn btn-primary w-full flex items-center justify-center space-x-2",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:"Search"})]})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Cash Receipts From: ",X(N.fromDate)," To: ",X(N.toDate)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[$.totalItems||0," records"]}),e.jsx("button",{onClick:()=>q(),className:"p-2 text-gray-400 hover:text-gray-600",title:"Refresh",children:e.jsx(ke,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"card-content p-0",children:Pe?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(ke,{className:"h-8 w-8 animate-spin mx-auto text-gray-400"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Loading cash receipts..."})]}):xe?e.jsx("div",{className:"p-8 text-center text-red-600",children:e.jsxs("p",{children:["Error loading cash receipts: ",J(xe).message]})}):je.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:e.jsx("p",{children:"No cash receipts found for the selected criteria."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>re("date"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Date"}),e.jsx(le,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>re("voucherCode"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Voucher Code"}),e.jsx(le,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>re("amount"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Amount"}),e.jsx(le,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Particular"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:je.map((s,n)=>e.jsxs("tr",{className:n%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:X(s.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.voucherCode}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Math.round(s.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.customer?s.customer.name:"N/A"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate",children:s.particular}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Xe(s),className:"text-green-600 hover:text-green-900",title:"Print",children:e.jsx(js,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Ye(s),className:"text-blue-600 hover:text-blue-900",title:"View",children:e.jsx(us,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Ie(s),className:"text-indigo-600 hover:text-indigo-900",title:"Edit",children:e.jsx(ys,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>We(s),className:"text-red-600 hover:text-red-900",title:"Delete",children:e.jsx(vs,{className:"h-4 w-4"})})]})})]},s._id))})]})}),$.totalPages>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>O(s=>({...s,page:s.page-1})),disabled:f.page===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{onClick:()=>O(s=>({...s,page:s.page+1})),disabled:f.page===$.totalPages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:(f.page-1)*f.limit+1})," ","to"," ",e.jsx("span",{className:"font-medium",children:Math.min(f.page*f.limit,$.totalItems)})," ","of"," ",e.jsx("span",{className:"font-medium",children:$.totalItems})," ","results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>O(s=>({...s,page:s.page-1})),disabled:f.page===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),Array.from({length:Math.min(5,$.totalPages)},(s,n)=>{const t=n+1;return e.jsx("button",{onClick:()=>O(c=>({...c,page:t})),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${f.page===t?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:t},t)}),e.jsx("button",{onClick:()=>O(s=>({...s,page:s.page+1})),disabled:f.page===$.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})})]})]})]})})]}),!1,Ae&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Cash Receipt"}),e.jsx("button",{onClick:()=>{W(!1),F(null),V()},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:l.date,onChange:s=>x(n=>({...n,date:s.target.value})),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:l.amount,onChange:s=>{const n=s.target.value===""?"":parseFloat(s.target.value)||"";x(t=>({...t,amount:n}))},className:"input w-full",placeholder:"0.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Particular"}),e.jsx("textarea",{value:l.particular,onChange:s=>x(n=>({...n,particular:s.target.value})),className:"input w-full",rows:"3",placeholder:"Enter transaction details...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer (Optional)"}),e.jsxs("select",{value:l.customer,onChange:s=>x(n=>({...n,customer:s.target.value})),className:"input w-full",disabled:pe,children:[e.jsx("option",{value:"",children:pe?"Loading customers...":"Select Customer"}),v==null?void 0:v.map(s=>e.jsxs("option",{value:s._id,children:[s.name," ",s.phone?`(${s.phone})`:""]},s._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:l.notes,onChange:s=>x(n=>({...n,notes:s.target.value})),className:"input w-full",rows:"2",placeholder:"Additional notes..."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>{W(!1),F(null),V()},className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:Je,disabled:ge,className:"btn btn-primary",children:ge?"Updating...":"Update"})]})]})})}),Me&&g&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Cash Receipt Details"}),e.jsx("button",{onClick:()=>{se(!1),F(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Voucher Code"}),e.jsx("p",{className:"text-sm text-gray-900",children:g.voucherCode})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("p",{className:"text-sm text-gray-900",children:X(g.date)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount"}),e.jsx("p",{className:"text-sm text-gray-900",children:Math.round(g.amount)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Particular"}),e.jsx("p",{className:"text-sm text-gray-900",children:g.particular})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsx("p",{className:"text-sm text-gray-900 capitalize",children:g.paymentMethod.replace("_"," ")})]}),g.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-900",children:g.notes})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Created By"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[(we=g.createdBy)==null?void 0:we.firstName," ",(Ce=g.createdBy)==null?void 0:Ce.lastName]})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>{se(!1),F(null)},className:"btn btn-secondary",children:"Close"})})]})})}),e.jsx(ps,{isOpen:_e,onClose:()=>{de(!1),ue(null)},orderData:I,documentTitle:"Cash Receipt",partyLabel:I!=null&&I.supplier?"Supplier":"Customer"})]})};export{Us as default};
