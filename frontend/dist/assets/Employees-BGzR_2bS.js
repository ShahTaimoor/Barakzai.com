import{G as te,r as p,R as q,y as j,p as e,S as se,ay as F,x as ae,O,U as re,ad as ne,X as le,B as C}from"./index-Cw3xRKpc.js";import{u as ie}from"./usersApi-CMNuj0nq.js";import{D as oe}from"./ConfirmationDialog-CxU4qXW2.js";import{a as ce}from"./useConfirmation-BJ-PhpCl.js";import{P as de}from"./plus-DxsvPhf3.js";import{P as me}from"./phone-D5Mv4op6.js";import{P as ue}from"./pen-square-XPG_rn4Q.js";import{T as pe}from"./trash-2-D2rrIU_x.js";import"./shield-Bzu0Nlf_.js";import"./check-circle-C7396OEq.js";import"./info-9RksQo07.js";const xe=te.injectEndpoints({endpoints:i=>({getEmployees:i.query({query:s=>({url:"employees",method:"get",params:s}),providesTags:s=>{var c;const o=((c=s==null?void 0:s.data)==null?void 0:c.employees)||(s==null?void 0:s.employees)||(s==null?void 0:s.items)||[];return o.length?[...o.map(({_id:g,id:b})=>({type:"Users",id:g||b})),{type:"Users",id:"EMPLOYEES_LIST"}]:[{type:"Users",id:"EMPLOYEES_LIST"}]}}),getEmployee:i.query({query:s=>({url:`employees/${s}`,method:"get"}),providesTags:(s,o,c)=>[{type:"Users",id:c}]}),createEmployee:i.mutation({query:s=>({url:"employees",method:"post",data:s}),invalidatesTags:[{type:"Users",id:"EMPLOYEES_LIST"}]}),updateEmployee:i.mutation({query:({id:s,...o})=>({url:`employees/${s}`,method:"put",data:o}),invalidatesTags:(s,o,{id:c})=>[{type:"Users",id:c},{type:"Users",id:"EMPLOYEES_LIST"}]}),deleteEmployee:i.mutation({query:s=>({url:`employees/${s}`,method:"delete"}),invalidatesTags:(s,o,c)=>[{type:"Users",id:c},{type:"Users",id:"EMPLOYEES_LIST"}]}),getDepartments:i.query({query:()=>({url:"employees/departments/list",method:"get"}),providesTags:[{type:"Settings",id:"DEPARTMENTS"}]}),getPositions:i.query({query:()=>({url:"employees/positions/list",method:"get"}),providesTags:[{type:"Settings",id:"POSITIONS"}]})}),overrideExisting:!1}),{useGetEmployeesQuery:ye,useCreateEmployeeMutation:he,useUpdateEmployeeMutation:ge,useDeleteEmployeeMutation:fe,useGetDepartmentsQuery:je,useGetPositionsQuery:be}=xe,Ue=()=>{var A,P,U,L;const[i,s]=p.useState(""),[o,c]=p.useState(""),[g,b]=p.useState(""),[x,y]=p.useState(1),[f,T]=p.useState(null),[D,N]=p.useState(!1),[a,n]=p.useState({firstName:"",lastName:"",employeeId:"",email:"",phone:"",position:"",department:"",hireDate:new Date().toISOString().split("T")[0],employmentType:"full_time",status:"active",salary:"",hourlyRate:"",payFrequency:"monthly",address:{street:"",city:"",state:"",zipCode:"",country:"US"},userAccount:"",notes:""}),{showDeleteDialog:M,handleDeleteClick:R,handleDeleteConfirm:$,handleDeleteCancel:z,itemToDelete:d}=ce(),{data:l,isLoading:v,refetch:G,error:E}=ye({search:i,status:o,department:g,page:x,limit:20},{keepPreviousData:!0});q.useEffect(()=>{E&&j(E,"Failed to fetch employees")},[E]);const{data:u}=ie({limit:100},{skip:!D,staleTime:5*60*1e3}),w=q.useMemo(()=>{var t;return((t=u==null?void 0:u.data)==null?void 0:t.users)||(u==null?void 0:u.users)||[]},[u]),{data:S}=je(),{data:Ne}=be(),k=((A=l==null?void 0:l.data)==null?void 0:A.employees)||(l==null?void 0:l.employees)||[],m=((P=l==null?void 0:l.data)==null?void 0:P.pagination)||(l==null?void 0:l.pagination)||{},[Y,{isLoading:I}]=he(),[Q,{isLoading:_}]=ge(),[B,{isLoading:ve}]=fe(),H=async t=>{try{await Y(t).unwrap(),C("Employee created successfully"),h()}catch(r){j(r,"Failed to create employee")}},W=async({id:t,data:r})=>{try{await Q({id:t,data:r}).unwrap(),C("Employee updated successfully"),h()}catch(ee){j(ee,"Failed to update employee")}},X=async t=>{try{await B(t).unwrap(),C("Employee deleted successfully")}catch(r){j(r,"Failed to delete employee")}},h=()=>{n({firstName:"",lastName:"",employeeId:"",email:"",phone:"",position:"",department:"",hireDate:new Date().toISOString().split("T")[0],employmentType:"full_time",status:"active",salary:"",hourlyRate:"",payFrequency:"monthly",address:{street:"",city:"",state:"",zipCode:"",country:"US"},userAccount:"",notes:""}),T(null),N(!1)},J=t=>{var r;T(t),n({firstName:t.firstName||"",lastName:t.lastName||"",employeeId:t.employeeId||"",email:t.email||"",phone:t.phone||"",position:t.position||"",department:t.department||"",hireDate:t.hireDate?new Date(t.hireDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],employmentType:t.employmentType||"full_time",status:t.status||"active",salary:t.salary||"",hourlyRate:t.hourlyRate||"",payFrequency:t.payFrequency||"monthly",address:t.address||{street:"",city:"",state:"",zipCode:"",country:"US"},userAccount:((r=t.userAccount)==null?void 0:r._id)||t.userAccount||"",notes:t.notes||""}),N(!0)},K=t=>{t.preventDefault();const r={...a};r.employeeId||delete r.employeeId,r.email||delete r.email,r.salary||delete r.salary,r.hourlyRate||delete r.hourlyRate,r.userAccount||delete r.userAccount,f?W({id:f._id,data:r}):H(r)},V=()=>{d&&X(d._id)},Z=()=>{$(),V()};return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Employees"}),e.jsx("p",{className:"text-gray-600",children:"Manage your staff and employee records"})]}),e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-content",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search employees...",value:i,onChange:t=>{s(t.target.value),y(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]})}),e.jsx("div",{children:e.jsxs("select",{value:o,onChange:t=>{c(t.target.value),y(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})}),e.jsx("div",{children:e.jsxs("select",{value:g,onChange:t=>{b(t.target.value),y(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Departments"}),(L=(U=S==null?void 0:S.data)==null?void 0:U.departments)==null?void 0:L.map(t=>e.jsx("option",{value:t,children:t},t))]})})]})})}),e.jsxs("div",{className:"card mb-6",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-5 w-5 text-gray-600"}),e.jsxs("h2",{className:"text-lg font-semibold",children:["Employees (",m.total||0,")"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>G(),className:"btn btn-secondary btn-sm",disabled:v,children:[e.jsx(ae,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),"Refresh"]}),e.jsxs("button",{onClick:()=>{h(),N(!0)},className:"btn btn-primary btn-sm",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Add Employee"]})]})]})}),e.jsxs("div",{className:"card-content",children:[v?e.jsx(O,{}):k.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(F,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No employees found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Employee ID"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Position"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Department"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Contact"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(t=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"font-mono text-sm",children:t.employeeId})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("span",{className:"font-medium",children:[t.firstName," ",t.lastName]})]})}),e.jsx("td",{className:"py-3 px-4",children:t.position}),e.jsx("td",{className:"py-3 px-4",children:t.department||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"text-sm",children:[t.email&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),t.email]}),t.phone&&e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),t.phone]})]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="active"?"bg-success-100 text-success-700":t.status==="terminated"?"bg-danger-100 text-danger-700":t.status==="on_leave"?"bg-warning-100 text-warning-700":"bg-gray-100 text-gray-700"}`,children:t.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>J(t),className:"btn btn-secondary btn-sm",title:"Edit",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(t),className:"btn btn-danger btn-sm",title:"Delete",children:e.jsx(pe,{className:"h-4 w-4"})})]})})]},t._id))})]})}),m.pages>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(x-1)*(m.limit||20)+1," to"," ",Math.min(x*(m.limit||20),m.total)," of"," ",m.total," employees"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>y(t=>Math.max(1,t-1)),disabled:x===1,className:"btn btn-secondary btn-sm",children:"Previous"}),e.jsx("button",{onClick:()=>y(t=>Math.min(m.pages,t+1)),disabled:x===m.pages,className:"btn btn-secondary btn-sm",children:"Next"})]})]})]})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:f?"Edit Employee":"Add New Employee"}),e.jsx("button",{onClick:h,className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx(le,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:a.firstName,onChange:t=>n({...a,firstName:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:a.lastName,onChange:t=>n({...a,lastName:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),e.jsx("input",{type:"text",value:a.employeeId,onChange:t=>n({...a,employeeId:t.target.value.toUpperCase()}),placeholder:"Auto-generated if left empty",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:t=>n({...a,email:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:a.phone,onChange:t=>n({...a,phone:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Position *"}),e.jsx("input",{type:"text",required:!0,value:a.position,onChange:t=>n({...a,position:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",value:a.department,onChange:t=>n({...a,department:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hire Date *"}),e.jsx("input",{type:"date",required:!0,value:a.hireDate,onChange:t=>n({...a,hireDate:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment Type"}),e.jsxs("select",{value:a.employmentType,onChange:t=>n({...a,employmentType:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"full_time",children:"Full Time"}),e.jsx("option",{value:"part_time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"temporary",children:"Temporary"}),e.jsx("option",{value:"intern",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:a.status,onChange:t=>n({...a,status:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"terminated",children:"Terminated"}),e.jsx("option",{value:"on_leave",children:"On Leave"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link User Account (Optional)"}),e.jsxs("select",{value:a.userAccount,onChange:t=>n({...a,userAccount:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"No User Account"}),w==null?void 0:w.filter(t=>!t.employeeLinked).map(t=>e.jsxs("option",{value:t._id,children:[t.firstName," ",t.lastName," (",t.email,")"]},t._id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Link to a system user account if employee needs POS access"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:h,className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:I||_,children:I||_?e.jsx(O,{size:"sm"}):f?"Update Employee":"Add Employee"})]})]})]})})}),e.jsx(oe,{isOpen:M,onClose:z,onConfirm:Z,title:"Delete Employee",message:`Are you sure you want to delete ${d==null?void 0:d.firstName} ${d==null?void 0:d.lastName}? This action cannot be undone.`})]})};export{Ue as default};
